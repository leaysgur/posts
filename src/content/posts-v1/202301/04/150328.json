{
  "title": "VimからNeovimに移行した",
  "html": "<p>移行しようと思ってしたというより、なりゆきでそうなっただけではあるけど。</p><p>が、結論としてはもっと早く移行すりゃよかった！というくらいに、Neovimいいやん！ってなってる。<br />\n<br />\n</p>\n\n<div class=\"section\">\n    <h3 id=\"ことの経緯\">ことの経緯</h3>\n    \n<div class=\"section\">\n    <h4 id=\"cocnvimやめるってよ\">`coc.nvim`やめるってよ</h4>\n    \n<ul>\n<li>もともとエディタはノーマル<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Vim\">Vim</a>をターミナル内で使ってた\n<ul>\n<li>みんな<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/VSCode\">VSCode</a>な中、やや疎外感を感じながらも</li>\n</ul></li>\n<li>LSPまわりは`coc.nvim`を使ってて、特に不満はなかった</li>\n</ul><p>が、ある日。</p><p>手元のNode.jsのバージョンを最新のLTSにあげたら、Svelteのエクステンションである`coc-svelte`が動かなくなった。</p><p>どうやら既知のIssueらしく、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%EA%A5%DD%A5%B8%A5%C8%A5%EA\">リポジトリ</a>にもPRが立ってた。</p>\n\n    <blockquote>\n        <p><a href=\"https://github.com/coc-extensions/coc-svelte/pull/60\">Fix coc-svelte not working with Node v18 by rudolfs &middot; Pull Request #60 &middot; coc-extensions/coc-svelte &middot; GitHub</a></p>\n\n    </blockquote>\n<p>が、1ヶ月以上も音沙汰ないし、そもそも半年以上も<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%EA%A5%DD%A5%B8%A5%C8%A5%EA\">リポジトリ</a>に動きがない。</p><p>手元でフォークしたものを使うのもありか・・？他のは動いてるし・・？って思いつつも、やっぱり嫌な予感がするということで、 `coc.nvim`ごとやめることにした。</p><p>Astroのエクステンションがなかったりと、地味に不満はあったし。</p>\n\n</div>\n<div class=\"section\">\n    <h4 id=\"asyncompleteとなぜか補完されないJSX\">`asyncomplete`と、なぜか補完されないJSX</h4>\n    <p>`coc.nvim`からの移行先としては、`<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/vim\">vim</a>-lsp`と`asyncomplete`の定番セットを選んだ。</p>\n<pre class=\"code lang-vim\" data-lang=\"vim\" data-unlink>Plug <span class=\"synConstant\">'prabirshrestha/vim-lsp'</span>\nPlug <span class=\"synConstant\">'mattn/vim-lsp-settings'</span>\nPlug <span class=\"synConstant\">'rhysd/vim-healthcheck'</span>\nPlug <span class=\"synConstant\">'prabirshrestha/asyncomplete.vim'</span>\nPlug <span class=\"synConstant\">'prabirshrestha/asyncomplete-lsp.vim'</span>\n\n<span class=\"synComment\">&quot; ...</span>\n\n<span class=\"synStatement\">let</span> <span class=\"synIdentifier\">g:lsp_use_native_client</span> <span class=\"synStatement\">=</span> <span class=\"synConstant\">1</span>\n<span class=\"synStatement\">let</span> <span class=\"synIdentifier\">g:lsp_document_code_action_signs_enabled</span> <span class=\"synStatement\">=</span> <span class=\"synConstant\">0</span>\n<span class=\"synStatement\">let</span> <span class=\"synIdentifier\">g:lsp_diagnostics_float_cursor</span> <span class=\"synStatement\">=</span> <span class=\"synConstant\">1</span>\n<span class=\"synStatement\">let</span> <span class=\"synIdentifier\">g:lsp_diagnostics_virtual_text_enabled</span> <span class=\"synStatement\">=</span> <span class=\"synConstant\">0</span>\n<span class=\"synStatement\">let</span> <span class=\"synIdentifier\">g:lsp_diagnostics_highlights_enabled</span> <span class=\"synStatement\">=</span> <span class=\"synConstant\">0</span>\n<span class=\"synStatement\">let</span> <span class=\"synIdentifier\">g:lsp_inlay_hints_enabled</span> <span class=\"synStatement\">=</span> <span class=\"synConstant\">1</span>\n<span class=\"synStatement\">let</span> <span class=\"synIdentifier\">g:lsp_semantic_enabled</span> <span class=\"synStatement\">=</span> <span class=\"synConstant\">1</span>\n</pre><p>見た目を整えるのが少し大変ではあったけど、他は問題なく移行できた。</p><p>SvelteのLSも最新のものが使えるようになったし、Astroまで対応してるし、やっぱ薄いものを組み合わせて使うのが好みやな〜これこれ〜って。</p><p>ただ1つ、問題を見つけてしまった。</p><p>それは、React/Preact/Solidなんでもいいけど、「JSXで補完がうまく効かない」というもの。</p>\n\n<ul>\n<li>独自<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%DD%A1%BC%A5%CD%A5%F3%A5%C8\">コンポーネント</a>のProps</li>\n<li>HTML要素の属性\n<ul>\n<li>`id`とか`class`とか</li>\n</ul></li>\n</ul><p>このあたりの補完が出ない。</p>\n\n<ul>\n<li>`lsp-hover`みたいなコマンドでは、型がちゃんと見れてる\n<ul>\n<li>ので、LSP側の問題ではなさそう？</li>\n</ul></li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/ARIA\">ARIA</a>まわりだけはなぜか補完されたり</li>\n</ul><p>というよくわからない状態で、たぶん`asyncomplete(-lsp)`の問題とは思うものの、他に悩んでる人がインターネットに見当たらず、自分の環境固有の問題かの判断もつかないまま、途方に暮れてた。</p><p>ただまぁ不便やな〜と思いつつ、幸い直近で<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%AC%A5%EA\">ガリ</a><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%AC%A5%EA\">ガリ</a>JSXを書く予定がなかったので、そのままにしてた。</p>\n\n</div>\n<div class=\"section\">\n    <h4 id=\"WeztermとVimのキーマップ問題\">Weztermと<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Vim\">Vim</a>のキーマップ問題</h4>\n    <p>時を同じくして、年末やし新たなターミナルでも開拓するか！ってことで、Weztermを少し試してた。</p>\n\n<ul>\n<li>Kittyは日本語の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/IME\">IME</a>まわりに問題あり</li>\n<li>Alacrittyはシンプルすぎて、いまさら`tmux`導入したくないしな・・</li>\n</ul><p>というわけで、Weztermはどストライクだった。使ってる機能的にはiTerm2と差異はないけど、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%EC%A5%F3%A5%C0%A5%EA%A5%F3%A5%B0\">レンダリング</a>まわりやUIがシュッとしてるのが好印象。</p><p>が、ここでも<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Vim\">Vim</a>とのかみ合わせの問題があり・・・。</p><p>それは、`/`キーのマップが突然動かなくなるというもの。詳細は以下のGistに。</p>\n\n    <blockquote>\n        <p><a href=\"https://gist.github.com/leader22/8b34c569ebff0fe88b2108dd01efb0d4?permalink_comment_id=4408020#gistcomment-4408020\">https://gist.github.com/leader22/8b34c569ebff0fe88b2108dd01efb0d4?permalink_comment_id=4408020#gistcomment-4408020</a></p>\n\n    </blockquote>\n<p>というところで、iTerm2に残留することにしてた。設定が`.plist`であること以外は特に不満はなかったし。</p>\n\n</div>\n<div class=\"section\">\n    <h4 id=\"Neovimとの出会い\">Neovimとの出会い</h4>\n    <p>JSXとの相性が悪いまま1ヶ月が経とうとしてたある日、たまたま目にしたNeovimの文字を見て、ちょっと試してみることにした。 LSPまわりはネイティブと`mason`と`nvim-cmp`の定番セットで。</p><p>そしたら、すべてうまく動くじゃないですか・・・🤯</p><p>もともとNeovimは<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/GUI\">GUI</a>で使うもんだとばかり思い込んでたけど、ターミナルからも普通に使えるし、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/SSH\">SSH</a>して作業することもなくなった今なら、ノーマル<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Vim\">Vim</a>に拘る必要なんかないのでは？って。</p><p>ということで、あっさりNeovimユーザーになることにした。今までありがとう普通の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Vim\">Vim</a>。</p>\n\n</div>\n</div>\n<div class=\"section\">\n    <h3 id=\"Hello-Neovim\">Hello, Neovim</h3>\n    <p>という経緯から、この度Neovimmerになったので、改めて設定や<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D7%A5%E9%A5%B0%A5%A4%A5%F3\">プラグイン</a>の見直しをやってたのがこの年末。</p>\n\n    <blockquote>\n        <p><a href=\"https://github.com/leader22/dotfiles/blob/b7db1af7ab13b44b892ee85b070e374dd3025338/init.lua\">https://github.com/leader22/dotfiles/blob/b7db1af7ab13b44b892ee85b070e374dd3025338/init.lua</a></p>\n\n    </blockquote>\n<p>これが今の設定のすべて。もともとファットに設定してたタイプではないので、200行くらいしかない。</p><p>（なら<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/VSCode\">VSCode</a>でいいのでは？って言われそうやけど、それは違うんだな〜。<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D7%A5%E9%A5%B0%A5%A4%A5%F3\">プラグイン</a>をとっかえひっかえしたり、設定ファイルという盆栽をちまちま育てていく・・、これだからエディタいじりは楽しい！！っていう。）</p><p>しかもNeovimにしたら、Weztermとの相性問題もあっさり解決するという棚ぼた展開までついてきて、ほんとに移行してよかった。</p><p>以上、`coc-svelte`をなんとかしようとしてたら、気がついたらNeovimになってたという話でした。</p><p>2023年、もし<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/VSCode\">VSCode</a>で`settings.<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/json\">json</a>`をあれこれ書いてる人がいたら、ぜひこっちの沼に引き込みたい。</p><p>設定ファイルもコツコツ育てていこう🐣</p>\n\n</div>"
}
