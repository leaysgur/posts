{
  "title": "Firefoxをソースからビルドする",
  "html": "<p>ちょっと所用があったので。</p>\n\n    <blockquote>\n        <p><a href=\"https://firefox-source-docs.mozilla.org/contributing/contribution_quickref.html\">Firefox Contributors&rsquo; Quick Reference &mdash; Firefox Source Docs documentation</a></p>\n\n    </blockquote>\n<p>ドキュメントがさすがにちゃんとしてて、基本的には全部ここに書いてあるけど、自分用にもメモを。<br />\n<br />\n</p>\n\n<div class=\"section\">\n    <h3 id=\"事前準備\">事前準備</h3>\n    <p><a class=\"keyword\" href=\"https://d.hatena.ne.jp/keyword/Firefox\">Firefox</a>のコードは<a class=\"keyword\" href=\"https://d.hatena.ne.jp/keyword/Mercurial\">Mercurial</a>で管理されてるけど、変換ツールを介することでGitも利用できるらしく、そっちを使ってみることに。</p>\n<pre class=\"code\" data-lang=\"\" data-unlink>brew install hg\nbrew install git-cinnabar</pre><p>他にも`<a class=\"keyword\" href=\"https://d.hatena.ne.jp/keyword/xcode\">xcode</a>-select`が必要らしいけど、既に入ってたのでスキップ。</p>\n\n</div>\n<div class=\"section\">\n    <h3 id=\"ブートストラップ\">ブートストラップ</h3>\n    <p>開発環境をセットアップするための<a class=\"keyword\" href=\"https://d.hatena.ne.jp/keyword/Python\">Python</a>の<a class=\"keyword\" href=\"https://d.hatena.ne.jp/keyword/%A5%B9%A5%AF%A5%EA%A5%D7%A5%C8\">スクリプト</a>があって、それを使うとのこと。</p>\n<pre class=\"code\" data-lang=\"\" data-unlink>curl https://hg.mozilla.org/mozilla-central/raw-file/default/python/mozboot/bin/bootstrap.py -O</pre><p>楽ちん。</p>\n\n<ul>\n<li>この時点ではディスク容量はまだ減らない\n<ul>\n<li>最低30GBあけておけって書いてあったけど、まだ大丈夫</li>\n</ul></li>\n<li>この`bootstrap.py`は後で消す？って聞いてくれるので、どこに置いてもよい\n<ul>\n<li>cloneする場所も別途で聞いてくれる</li>\n</ul></li>\n</ul><p>いざ実行で、Gitでやりたいですフラグを渡す。</p>\n<pre class=\"code\" data-lang=\"\" data-unlink>python3 bootstrap.py --vcs=git</pre><p>ダウンロードがはじまってディスク容量を消費しはじめる。</p>\n\n<ul>\n<li>コントリビュートが目的なら、各種アカウントも用意しろって言われて<a class=\"keyword\" href=\"https://d.hatena.ne.jp/keyword/%A5%C8%A1%BC%A5%AF\">トーク</a>ンを要求されたりする\n<ul>\n<li>BugzillaとPhabricator</li>\n<li>Phabricatorは、usernameを後から自分で変更できないので要注意（まじで）</li>\n</ul></li>\n<li><a class=\"keyword\" href=\"https://d.hatena.ne.jp/keyword/C%2B%2B\">C++</a>みたいなコードを変更しない場合は、ビルド済バイナリを利用できる<a class=\"keyword\" href=\"https://d.hatena.ne.jp/keyword/%A5%A2%A1%BC%A5%C6%A5%A3%A5%D5%A5%A1%A5%AF%A5%C8\">アーティファクト</a>モードなる方法が選べる\n<ul>\n<li>それを使うようにすると、ディスク容量も抑えられるぽい</li>\n<li>最終的に、10GBくらいあればよさそうだった</li>\n</ul></li>\n</ul><p>さすがにダウンロードに時間がかかる。</p>\n\n</div>\n<div class=\"section\">\n    <h3 id=\"ビルドと実行\">ビルドと実行</h3>\n    <pre class=\"code\" data-lang=\"\" data-unlink>./mach build\n./mach run</pre><p>マッハ！っていうコマンドがある。本当に楽ちん・・・。</p>\n\n<ul>\n<li><a class=\"keyword\" href=\"https://d.hatena.ne.jp/keyword/%A5%A2%A1%BC%A5%C6%A5%A3%A5%D5%A5%A1%A5%AF%A5%C8\">アーティファクト</a>モードならあっさりビルドできる\n<ul>\n<li>2015年製のMBPでも、初回が2-3分くらいで後は1分以内に終わる</li>\n<li>900MBくらいの<a class=\"keyword\" href=\"https://d.hatena.ne.jp/keyword/%A5%C7%A5%A3%A5%EC%A5%AF%A5%C8\">ディレクト</a>リが誕生した</li>\n</ul></li>\n<li>`./<a class=\"keyword\" href=\"https://d.hatena.ne.jp/keyword/mach\">mach</a> build faster`とすると、さらに短縮できる\n<ul>\n<li>ローカルのJSや<a class=\"keyword\" href=\"https://d.hatena.ne.jp/keyword/CSS\">CSS</a>だけをビルドするらしい</li>\n</ul></li>\n</ul><p>起動するとNightlyの<a class=\"keyword\" href=\"https://d.hatena.ne.jp/keyword/Firefox\">Firefox</a>とご対面できる！</p><p><a class=\"keyword\" href=\"https://d.hatena.ne.jp/keyword/%A5%C7%A5%A3%A5%EC%A5%AF%A5%C8\">ディレクト</a>リ探訪や、コードの修正・反映やらは、またの機会にやってみたい。</p>\n\n</div>"
}
