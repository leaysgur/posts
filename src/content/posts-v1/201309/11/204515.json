{
  "title": "apple-mobile-web-app-capableの挙動について",
  "html": "<p>通常のWebページを、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Safari\">Safari</a>ではなく独自のアプリっぽい見せ方で表示できるという噂のプロパティです。</p><p>ただこのプロパティ、情報なさすぎや・・・。<br />\nとりあえずわかったことのメモ。</p><p></p>\n\n<div class=\"section\">\n    <h3>設定</h3>\n    <p>設定するには、以下を指定。</p>\n<pre class=\"code lang-html\" data-lang=\"html\" data-unlink><span class=\"synIdentifier\">&lt;</span><span class=\"synStatement\">meta</span><span class=\"synIdentifier\"> </span><span class=\"synType\">name</span><span class=\"synIdentifier\">=</span><span class=\"synConstant\">&quot;apple-mobile-web-app-capable&quot;</span><span class=\"synIdentifier\"> </span><span class=\"synType\">content</span><span class=\"synIdentifier\">=</span><span class=\"synConstant\">&quot;yes&quot;</span><span class=\"synIdentifier\">&gt;</span>\n</pre><p>iPhone5の場合、あわせて以下を指定。</p>\n<pre class=\"code lang-html\" data-lang=\"html\" data-unlink><span class=\"synIdentifier\">&lt;</span><span class=\"synStatement\">meta</span><span class=\"synIdentifier\"> </span><span class=\"synType\">name</span><span class=\"synIdentifier\">=</span><span class=\"synConstant\">&quot;viewport&quot;</span><span class=\"synIdentifier\"> </span><span class=\"synType\">content</span><span class=\"synIdentifier\">=</span><span class=\"synConstant\">&quot;initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no&quot;</span><span class=\"synIdentifier\">&gt;</span>\n</pre><p>キモは、widthの指定をしていないところと、initial-scale=1なところ。<br />\nこうしないと、iPhone5では上下のセンター寄せみたいになります。</p><p>使う分にはコレだけです。</p>\n\n<div class=\"section\">\n    <h4>おまけ</h4>\n    <p>上記設定でフルスクリーン化しているときは、</p>\n<pre class=\"code lang-html\" data-lang=\"html\" data-unlink><span class=\"synIdentifier\">&lt;</span><span class=\"synStatement\">meta</span><span class=\"synIdentifier\"> </span><span class=\"synType\">name</span><span class=\"synIdentifier\">=</span><span class=\"synConstant\">&quot;apple-mobile-web-app-status-bar-style&quot;</span><span class=\"synIdentifier\"> </span><span class=\"synType\">content</span><span class=\"synIdentifier\">=</span><span class=\"synConstant\">&quot;black&quot;</span><span class=\"synIdentifier\"> /&gt;</span>\n</pre><p>このプロパティで、唯一残存するステータスバーの色や挙動を変えられます。</p><p>つぎ。</p>\n\n    <blockquote>\n        <p>このフルスクリーン状態は、以後便宜上「<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%BF%A5%F3%A5%C9%A5%A2%A5%ED%A5%F3\">スタンドアロン</a>モード」と呼称します。</p>\n\n    </blockquote>\n\n</div>\n</div>\n<div class=\"section\">\n    <h3>ページ遷移について</h3>\n    <p>聞くところによると、</p>\n\n<ul>\n<li>ページ遷移をjsで制御する必要がある</li>\n</ul><p>なのですが、これがどうやら仕様が変わっているぽい。</p><p>手元で試したところだと、一旦<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%BF%A5%F3%A5%C9%A5%A2%A5%ED%A5%F3\">スタンドアロン</a>モードに入ってしまえば、<br />\n\"同一オリジン\"なら<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%BF%A5%F3%A5%C9%A5%A2%A5%ED%A5%F3\">スタンドアロン</a>モードが継続する、模様。<br />\n・・・まじか！w</p><p>そしてそして、</p>\n<pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink><span class=\"synStatement\">location</span>.href = <span class=\"synConstant\">'http://www.google.com/'</span>\n</pre><p>まさかのこれも同じく<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%BF%A5%F3%A5%C9%A5%A2%A5%ED%A5%F3\">スタンドアロン</a>モード継続。</p><p>調べてみたところ、<br />\n別オリジンへ向いたanchorタグを直接踏む\"以外\"なら、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%BF%A5%F3%A5%C9%A5%A2%A5%ED%A5%F3\">スタンドアロン</a>モードが継続するっぽい。<br />\nたぶんformもアウトですね、たぶん。<br />\nサーバーサイドでリダイレクトするにしても、上記の通りjsで遷移するにしても、直接踏まなければOKっぽい。</p><p>うーん、要検証。</p>\n\n    <blockquote>\n        <p>ページ読み込みが完了しない間際にリンクを連打したりすると、同一オリジンであっても<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Safari\">Safari</a>が立ち上がってきたり、よーわからんです。</p>\n\n    </blockquote>\n\n</div>\n<div class=\"section\">\n    <h3><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/JavaScript\">JavaScript</a>からは</h3>\n    <pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink><span class=\"synStatement\">window</span>.navigator.standalone\n</pre><p>これが<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%BF%A5%F3%A5%C9%A5%A2%A5%ED%A5%F3\">スタンドアロン</a>モードではtrueになる。<br />\n一旦<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%BF%A5%F3%A5%C9%A5%A2%A5%ED%A5%F3\">スタンドアロン</a>モードになっていれば、例のmetaタグがなくてもtrueが返る。</p><p>そして、これは実機でしか取れない・・・。</p>\n\n</div>\n<div class=\"section\">\n    <h3>いわゆるデメリット</h3>\n    \n<ul>\n<li>予期せぬエラーを踏むと＼(^o^)／</li>\n<li>リロードできない</li>\n<li>ブラウザバックできない</li>\n</ul><p>リロードもできないので404系のエラーとか、jsのエラーでアンコントローラブルになってしまうと、本当にツミマス。<br />\n自サイトは徹底的に導線精査して解決するにしても、完全に他サイトに行かれてしまうと、もちろん戻るリンクなんて存在しないので、サヨナラです。</p><br />\n<p>iOS7の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Safari\">Safari</a>対策として使えそうで使えないようで使える・・うーん。</p>\n\n</div>\n<div class=\"section\">\n    <h3>リファレンス</h3>\n    <p>リンク、置いておきます。</p>\n\n    <blockquote>\n        <p>iOS7 Pre-Releaseのドキュメント(要AppleID)：<a href=\"https://developer.apple.com/library/prerelease/ios/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html\" target=\"_blank\" title=\"Safari Web Content Guide\">Safari Web Content Guide</a></p>\n\n    </blockquote>\n\n    <blockquote>\n        <p>通常<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iOS\">iOS</a>のドキュメント：<a href=\"https://developer.apple.com/library/ios/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html\" target=\"_blank\" title=\"Safari Web Content Guide\">Safari Web Content Guide</a></p>\n\n    </blockquote>\n\n</div>"
}
