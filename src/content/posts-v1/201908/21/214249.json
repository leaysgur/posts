{
  "title": "SkyWay UG Tokyo #4 に行ってきたメモ #WebRTCSkyWay",
  "html": "\n    <blockquote>\n        <p><a href=\"https://skyway.connpass.com/event/140879/\">SkyWay UG Tokyo #4 - connpass</a></p>\n\n    </blockquote>\n<p>今回は弊社の新オフィス（開発拠点）にて。<br />\n<br />\n</p>\n\n<div class=\"section\">\n    <h3>Media Pipeline Factoryを使った音声録音について</h3>\n    \n    <blockquote>\n        <p><a href=\"https://slides.com/kazukitahara-1/skyway-media/fullscreen\">skyway Media Pipeline Factory&#x3092;&#x5229;&#x7528;&#x3057;&#x305F;&#x97F3;&#x58F0;&#x9332;&#x97F3;&#x306B;&#x304A;&#x3051;&#x308B;&#x5B9F;&#x7528;&#x4F8B;&#x306B;&#x3064;&#x3044;&#x3066;</a></p>\n\n    </blockquote>\n<p>レアジョブの田原さんより。</p>\n\n<div class=\"section\">\n    <h4>はじめに</h4>\n    \n<ul>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Skype\">Skype</a>を使って英会話のサービスをやってたけど、SkyWayに移行</li>\n<li>生徒側と講師側のアプリがあって、1:1のレッスンルーム\n<ul>\n<li>どっちもVue.js製</li>\n<li>講師はフィリピンからWebRTC！</li>\n</ul></li>\n</ul>\n</div>\n<div class=\"section\">\n    <h4>録音</h4>\n    \n<ul>\n<li>SkyWayのMediaPipelineFactoryを使って、レッスンを録音</li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/AWS\">AWS</a>のS3に`.wav`が保存されるので、あとで`mp3`にして利用</li>\n<li>レッスンに使う`Peer`とは別に、録音用に`Peer`を用意して使う</li>\n<li>生徒と講師のストリームをまとめて録音\n<ul>\n<li>WebAudioで1つに混ぜてる</li>\n</ul></li>\n<li>レッスンの仕様上の苦労\n<ul>\n<li>録音ファイルの置き場が複数になっちゃう</li>\n<li>双方向なストリームと、片方向があって取り回しで苦労した</li>\n</ul></li>\n<li>NTT Com.との協業も\n<ul>\n<li><a href=\"https://www.rarejob.co.jp/news/news_release/corporate/2019/0123/5974/\">https://www.rarejob.co.jp/news/news_release/corporate/2019/0123/5974/</a></li>\n</ul></li>\n</ul>\n</div>\n</div>\n<div class=\"section\">\n    <h3><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/VR\">VR</a>業界の制約と誓約とSkyWay</h3>\n    \n    <blockquote>\n        <p>資料は見つけたら</p>\n\n    </blockquote>\n<p>ハコスコの松原さん、加藤さんより。</p>\n\n<div class=\"section\">\n    <h4>ハコスコについて</h4>\n    \n<ul>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/VR\">VR</a>デ<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D0%A5%A4%A5%B9\">バイス</a>のライフサイクルの速さにどう追従するか</li>\n<li>そのうえで普遍的な環境で動作させたい</li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/VR\">VR</a>を使ったサービスだけでなくアート作品も\n<ul>\n<li>代表は<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%C7%BE%B2%CA%B3%D8\">脳科学</a>に精通している</li>\n</ul></li>\n<li>ハコスコ = <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C0%A5%F3%A5%DC%A1%BC\">ダンボー</a>ルでできたヘッドマウントディスプレイ</li>\n<li>360度<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/VR\">VR</a>コンテンツをワンストップで提供できるプラットフォーム\n<ul>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%F3%A5%B3%A1%BC%A5%C9\">エンコード</a></li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A1%BC%A5%AB%A5%A4%A5%D6\">アーカイブ</a></li>\n<li>Live配信</li>\n</ul></li>\n<li>視聴環境も内製してます\n<ul>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iOS\">iOS</a>/<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Android\">Android</a>向け</li>\n<li>WebVRを使ったもの</li>\n</ul></li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/VR\">VR</a>に必要なすべてをワンストップで提供！</li>\n</ul>\n</div>\n<div class=\"section\">\n    <h4>ハコスコナビ</h4>\n    \n<ul>\n<li>SkyWayを利用して開発した</li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/VR\">VR</a>空間プレゼンツール\n<ul>\n<li><a href=\"https://hacosco.com/navi/\">https://hacosco.com/navi/</a></li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/VR\">VR</a>の360度動画を、複数人で視聴できる</li>\n<li>ナビゲーターが案内</li>\n<li>双方向で音声通話しながら</li>\n<li>視聴者がどこを見てるかも取れる</li>\n</ul></li>\n</ul>\n</div>\n<div class=\"section\">\n    <h4>実装について</h4>\n    \n<ul>\n<li>ヘッドマウントディスプレイの数の多さ\n<ul>\n<li>2013年くらいから</li>\n</ul></li>\n<li>考えた要件\n<ul>\n<li>複数人で体験を共有できる</li>\n<li>音声通話</li>\n<li>ナビゲーターと視聴者で非対称な操作</li>\n</ul></li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Web%A5%D6%A5%E9%A5%A6%A5%B6\">Webブラウザ</a>でも動作させたい\n<ul>\n<li>メディアは<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/CDN\">CDN</a>から取得</li>\n<li>それを見ながら<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%DC%A5%A4%A5%B9%A5%C1%A5%E3%A5%C3%A5%C8\">ボイスチャット</a>を提供</li>\n</ul></li>\n</ul>\n</div>\n<div class=\"section\">\n    <h4>要件定義</h4>\n    \n<ul>\n<li>モック開発時はWebSocketを使っていた\n<ul>\n<li>しかしパフォーマンスの問題が</li>\n</ul></li>\n<li>そこでWebRTCのDataChannelが使えるサービスを探した\n<ul>\n<li>SkyWayだ！</li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B7%A5%B0%A5%CA%A5%EA%A5%F3%A5%B0\">シグナリング</a>サーバーもある！</li>\n<li>ルームの概念もある！</li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/SDK\">SDK</a>のコードが読める！</li>\n</ul></li>\n</ul>\n</div>\n<div class=\"section\">\n    <h4>動画をどうするか</h4>\n    \n<ul>\n<li>WebRTCでやりとりできる解像度の限界\n<ul>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%DE%A5%DB\">スマホ</a>の回線で快適に配信できるかが課題</li>\n</ul></li>\n<li>なので<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/CDN\">CDN</a>で静的に配信</li>\n</ul>\n</div>\n<div class=\"section\">\n    <h4>開発時の要望</h4>\n    \n<ul>\n<li>多彩な環境で視聴したい\n<ul>\n<li>ブラウザ、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%DE%A5%DB\">スマホ</a>、Oculus</li>\n</ul></li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iPad\">iPad</a>でナビゲーターしたい</li>\n<li>ミュートはナビゲーターが行う\n<ul>\n<li>同じ部屋でやると</li>\n</ul></li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iOS\">iOS</a>/<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Android\">Android</a>でのトラブル\n<ul>\n<li>HLSの再生方式（<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iOS\">iOS</a>はライブラリを使わない</li>\n<li>MediaStreamの再生がおかしくなってた頃もあった</li>\n</ul></li>\n</ul>\n</div>\n</div>\n<div class=\"section\">\n    <h3>vmeets: SkyWayを使った<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%D0%A5%BF%A1%BC\">アバター</a>コミュニケーションサービス</h3>\n    \n    <blockquote>\n        <p>資料は見つけたら</p>\n\n    </blockquote>\n<p>時空テク<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%CE%A5%ED\">ノロ</a><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B8%A1%BC\">ジー</a>の春日さんより。</p>\n\n<div class=\"section\">\n    <h4>vmeets</h4>\n    \n<ul>\n<li><a href=\"https://broadcast.vmeets.io/\">https://broadcast.vmeets.io/</a>\n<ul>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%D0%A5%BF%A1%BC\">アバター</a>で<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C6%A5%EC%A5%D3%B2%F1%B5%C4\">テレビ会議</a>ができるサービス</li>\n</ul></li>\n<li>なぜ<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%D0%A5%BF%A1%BC\">アバター</a>か\n<ul>\n<li>部屋の映り込み、服や化粧などを気にしなくてよい</li>\n</ul></li>\n<li>ビデオ通話におけるカメラいる？問題\n<ul>\n<li>メリットもデメリットもある</li>\n</ul></li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%D0%A5%BF%A1%BC\">アバター</a>ならいいとこ取りできる！</li>\n<li>自作の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%D0%A5%BF%A1%BC\">アバター</a>も動かせる\n<ul>\n<li>Live2D</li>\n</ul></li>\n</ul>\n</div>\n<div class=\"section\">\n    <h4>つかいかた</h4>\n    \n<ul>\n<li>ルーム名を指定して入る</li>\n<li>好きな<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%D0%A5%BF%A1%BC\">アバター</a>を選ぶ\n<ul>\n<li>もちろんカメラ映像そのままでも</li>\n</ul></li>\n<li>あとは自分の表情がキャプチャされて、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%D0%A5%BF%A1%BC\">アバター</a>に反映される</li>\n<li>その他、会議に必要な機能を網羅\n<ul>\n<li>チャット</li>\n<li>画面共有</li>\n<li>お絵かき</li>\n<li>文字起こし</li>\n<li>etc...</li>\n</ul></li>\n<li>複数人でLive放送できるような仕組みも</li>\n</ul>\n</div>\n<div class=\"section\">\n    <h4>支える技術</h4>\n    \n<ul>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Web%A5%B5%A1%BC%A5%D3%A5%B9\">Webサービス</a>\n<ul>\n<li>データアクセス・保存</li>\n</ul></li>\n<li>リアルタイムプロセス\n<ul>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%D0%A5%BF%A1%BC\">アバター</a>の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%EC%A5%F3%A5%C0%A5%EA%A5%F3%A5%B0\">レンダリング</a></li>\n<li>フェイシャルキャプチャー</li>\n</ul></li>\n<li>ネットワーク\n<ul>\n<li>WebRTC = SkyWay</li>\n</ul></li>\n<li>技術スタック\n<ul>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/AWS\">AWS</a></li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Python\">Python</a>: MLとの親和性</li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Django\">Django</a></li>\n<li>three.js: 信頼と実績</li>\n<li>Live2D, <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/VRM\">VRM</a>, Pera2D</li>\n<li>clmtrackr: JSのライブラリの中では制度がよく、軽い\n<ul>\n<li><a href=\"https://github.com/auduno/clmtrackr\">https://github.com/auduno/clmtrackr</a></li>\n</ul></li>\n</ul></li>\n</ul>\n</div>\n<div class=\"section\">\n    <h4>知見</h4>\n    \n<ul>\n<li>まだアルファ版のサービスではあるが、試行錯誤があった</li>\n<li>`rAF`ベースのフレーム単位での処理と、その他イベントベースの処理の組み合わせ\n<ul>\n<li>たとえば<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%D0%A5%BF%A1%BC\">アバター</a>のモデルを変更した時とかに整合性の問題が</li>\n</ul></li>\n<li>音声のクオリティ\n<ul>\n<li>OPUSで固定しても解決しない</li>\n<li>WebRTCなので、帯域が自動で調整されてしまう</li>\n</ul></li>\n<li>帯域のバランス調整がむずかしい\n<ul>\n<li>パラメータが増えるとそれだけ難易度が上がってしまう</li>\n<li>サービスでパラメータを減らす努力を</li>\n</ul></li>\n</ul>\n</div>\n<div class=\"section\">\n    <h4>SkyWayへの不満</h4>\n    \n<ul>\n<li>ストリーム・トラックの管理に自由度がない\n<ul>\n<li>複数のトラックのために複数のPeerが</li>\n</ul></li>\n<li><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/SFU\">SFU</a>とMeshで挙動が違う\n<ul>\n<li>使う帯域が違うだけでなく</li>\n</ul></li>\n<li>エラーのコールバックがどこの<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a>によるものかわからない\n<ul>\n<li>自分たちでトレースするしかない</li>\n</ul></li>\n<li>シンプルに使えていいけど、より細かい制御がしたい</li>\n</ul>\n</div>\n</div>\n<div class=\"section\">\n    <h3>SkyWay Conference 〜JS-<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/SDK\">SDK</a>で作る会議アプリ〜</h3>\n    \n    <blockquote>\n        <p><a href=\"https://leader22.github.io/slides/skyway_ug_tokyo-4\">SkyWay Conference &#x301C;JS-SDK&#x3067;&#x4F5C;&#x308B;&#x4F1A;&#x8B70;&#x30A2;&#x30D7;&#x30EA;&#x301C;</a></p>\n\n    </blockquote>\n<p>久しぶりの登壇でした。</p><p>内容は資料のまんまです！質問などあれば<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Twitter\">Twitter</a>までどうぞお気軽に。</p>\n\n</div>\n<div class=\"section\">\n    <h3>懇親会 + LT</h3>\n    <p>🍕がきてしまったので、メモがあるだけになります・・・。</p>\n\n<div class=\"section\">\n    <h4>SkyWayのお型付け by @sublimer</h4>\n    \n    <blockquote>\n        <p><a href=\"http://sublimer.me/slides/skyway-ug/skyway-ug-tokyo-4/\">SkyWay&#x306E;&#x304A;&#x578B;&#x4ED8;&#x3051;</a></p>\n\n    </blockquote>\n\n<ul>\n<li>SkyWayをTSで使えるのはよい</li>\n<li>このスライドもReveal.js</li>\n<li>それをDC張って操作できるようにした</li>\n<li><a href=\"https://github.com/kadoshita/revealjs-controller\">https://github.com/kadoshita/revealjs-controller</a></li>\n</ul>\n</div>\n<div class=\"section\">\n    <h4>puppeteer を使ってサーバーレスで録音してみた by @kiyoshi_ohno</h4>\n    \n    <blockquote>\n        <p><a href=\"https://speakerdeck.com/cloudliner/puppeteer-woshi-tutesabaresudelu-yin-sitemita\">puppeteer &#x3092;&#x4F7F;&#x3063;&#x3066;&#x30B5;&#x30FC;&#x30D0;&#x30FC;&#x30EC;&#x30B9;&#x3067;&#x9332;&#x97F3;&#x3057;&#x3066;&#x307F;&#x305F; - Speaker Deck</a></p>\n\n    </blockquote>\n\n<ul>\n<li>録音したい</li>\n<li>CloundFunctionでやると、実行時間に制限がある</li>\n<li>GAEだとスケールの問題が</li>\n<li>最終的にGKEで</li>\n</ul>\n</div>\n<div class=\"section\">\n    <h4><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iOS\">iOS</a>のCallKitフレームークとSkyWayについて by @yorifuji</h4>\n    \n    <blockquote>\n        <p><a href=\"https://note.mu/yorifuji/n/n37122f2adb0d\">iOS&#x3067;CallKit&#x3068;WebRTC&#x3092;&#x4F7F;&#x3063;&#x3066;&#x30D3;&#x30C7;&#x30AA;&#x901A;&#x8A71;&#x30A2;&#x30D7;&#x30EA;&#x3092;&#x4F5C;&#x308B;&#xFF5C;&#x3088;&#x308A;&#x3075;&#x3058;&#xFF5C;note</a></p>\n\n    </blockquote>\n\n<ul>\n<li>DCでつないで通知だす</li>\n<li>それを受けてメディアを通す</li>\n</ul>\n</div>\n<div class=\"section\">\n    <h4>SkyWay <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Gateway\">Gateway</a>を使ってブラウザから操作できるロボットを作ってみた by @harmoniko</h4>\n    \n    <blockquote>\n        <p>資料は見つけたら</p>\n\n    </blockquote>\n\n<ul>\n<li>ラズパイを載せたラジコン！</li>\n<li>会場の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/WiFi\">WiFi</a>情報とかは、SDカードのFATのほうに書いておく</li>\n<li>暴走しないように<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/ping\">ping</a>/pongするとか</li>\n</ul>\n</div>\n</div>\n<div class=\"section\">\n    <h3>そのほか</h3>\n    \n<ul>\n<li>話した内容が思った以上にウケててよかった</li>\n<li>DataChannelのユーザーが多くて意外だった</li>\n<li>みんな<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iOS\">iOS</a> <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Safari\">Safari</a>の`setSinkId()`を熱望してた</li>\n<li>stream/trackの取り回しはやっぱ不満ですよね〜</li>\n</ul>\n</div>"
}
