{
  "title": "VimでもSvelteをTypeScriptで書きたい",
  "html": "<p>TypeScript対応が入って久しいSvelteですが、いざその恩恵に預かって快適コーディングするためには、LSPのサポートが必須な今日このごろ。</p><p>ただ、界隈のLSPにシュッと対応したエディタといえば<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/VSCode\">VSCode</a>の話ばっかりで、こちとら<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Vim\">Vim</a>なんですが！！って感じだった。<br />\n今まで使ってたALEにもLSPの機能はあるみたいやったけど、手元の構成だとうまく動かせなくて詰んでた。</p><p>けど、改めて探してみたら、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Vim\">Vim</a>でもいい感じにできる<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D7%A5%E9%A5%B0%A5%A4%A5%F3\">プラグイン</a>が普通にあったわ・・という話。<br />\n<br />\n</p>\n\n<div class=\"section\">\n    <h3>coc.nvim</h3>\n    \n    <blockquote>\n        <p><a href=\"https://github.com/neoclide/coc.nvim\">GitHub - neoclide/coc.nvim: Nodejs extension host for vim &amp; neovim, load extensions like VSCode and host language servers.</a></p>\n\n    </blockquote>\n<p>さすが「Conquer of Completion」っていうつよいネーミングなだけある。</p><p>これを、懇意にしているパッケージマネージャーでインストールする。</p>\n<pre class=\"code lang-vim\" data-lang=\"vim\" data-unlink>Plug <span class=\"synConstant\">'neoclide/coc.nvim'</span>, <span class=\"synSpecial\">{</span><span class=\"synConstant\">'branch'</span>: <span class=\"synConstant\">'release'</span><span class=\"synSpecial\">}</span>\n</pre><p>Node.jsに依存することにはなるけど、どうせ入ってるのでまぁよし。</p><p>READMEに、おすすめ`.vimrc`の記述があるので忘れずに。</p><p>個人的に全部はいらないと思ったので、基本的なやつとTABで補完リストを選べるようにするやつだけコピった。</p>\n\n</div>\n<div class=\"section\">\n    <h3>coc-svelte</h3>\n    \n    <blockquote>\n        <p><a href=\"https://github.com/coc-extensions/coc-svelte\">GitHub - coc-extensions/coc-svelte: svelte support for (Neo)Vim</a></p>\n\n    </blockquote>\n<p>CoCは各種サポートを<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B3%C8%C4%A5%B5%A1%C7%BD\">拡張機能</a>で提供するので、Svelte用のそれを入れる。</p><p>拡張は<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Vim\">Vim</a>上から`:CocInstall coc-svelte`って実行することでインストールする。</p><p>`.vimrc`に書くことでもインストールできるけど、こっちの方法がおすすめって書いてあった。</p><p>なんとこれだけでLSPの機能が使えるようになる・・・。</p><p>デフォルトのファイルタイプだと、`.svelte`はナニソレ状態なので、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B7%A5%F3%A5%BF%A5%C3%A5%AF%A5%B9\">シンタックス</a>ハイライトは自分で用意する必要があることに注意。</p><p>`leafOfTree/<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/vim\">vim</a>-svelte-plugin`とか、`evanleck/<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/vim\">vim</a>-svelte`とか。</p>\n\n</div>\n<div class=\"section\">\n    <h3>:CocConfig</h3>\n    <p>CoC自体の設定を変えるには、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Vim\">Vim</a>上で`:CocConfig`コマンドを入力する。<br />\nすると設定ファイルが開く。なので、直接そのファイル（`~/.<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/vim\">vim</a>/coc-settings.<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/json\">json</a>`）を修正してもいいはず。</p><p>今の設定はこんな感じ。</p>\n<pre class=\"code lang-json\" data-lang=\"json\" data-unlink><span class=\"synSpecial\">{</span>\n  &quot;<span class=\"synStatement\">coc.preferences.extensionUpdateCheck</span>&quot;: &quot;<span class=\"synConstant\">daily</span>&quot;,\n  &quot;<span class=\"synStatement\">diagnostic.checkCurrentLine</span>&quot;: <span class=\"synConstant\">true</span>,\n  &quot;<span class=\"synStatement\">tsserver.enableJavascript</span>&quot;: <span class=\"synConstant\">false</span>,\n  &quot;<span class=\"synStatement\">eslint.autoFixOnSave</span>&quot;: <span class=\"synConstant\">true</span>\n<span class=\"synSpecial\">}</span>\n</pre><p>上から、</p>\n\n<ul>\n<li>拡張のアップデートを毎日チェックする</li>\n<li>TSやESLintのエラー内容を、行単位で表示する（デフォルトは文字単位）</li>\n<li>`.js`ファイルでは、`tsserver`を起動しない</li>\n<li>保存時に`eslint --fix`する</li>\n</ul><p>ほぼ<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/VSCode\">VSCode</a>のそれ。</p><p>ちなみに<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/JSON\">JSON</a>を修正するときには、`coc-<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/json\">json</a>`を入れておくとこれまたいい感じにしてくれる。</p>\n\n</div>\n<div class=\"section\">\n    <h3>というわけで</h3>\n    <p>CoCがすごくて感動したという話でした。<br />\n拡張も<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/VSCode\">VSCode</a>の拡張をフォークして作れるみたいなデザインらしく、他にも便利なやつありそう。</p><p>ちなみに、最近のマイ`.vimrc`はこんな感じ。</p>\n\n    <blockquote>\n        <p><a href=\"https://github.com/leader22/dotfiles/blob/master/.vimrc\">https://github.com/leader22/dotfiles/blob/master/.vimrc</a></p>\n\n    </blockquote>\n<p>もうひとつちなむと、SvelteをTSで書けるようにはなったけど、それで満足に型安全なコードが書けるのか？と問われると、今のところまだ微妙と言わざるを得ない・・というのが正直な感想。</p>\n\n</div>"
}
