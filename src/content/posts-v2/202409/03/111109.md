---
title: Prettier ã®ãƒ‡ãƒãƒƒã‚°æ–¹æ³•ã«ã¤ã„ã¦
---

ã‚³ãƒ¼ãƒ‰ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ã™ã‚‹éç¨‹ã§ã€Prettierã®ãƒ‡ãƒãƒƒã‚°æ–¹æ³•ã«ã¤ã„ã¦ã‚‚ãªã‚“ã¨ãªãã‚ã‹ã£ã¦ããŸã®ã§ã¾ã¨ã‚ã¦ãŠãã€‚

## Playground

> https://prettier.io/playground/

å·¦ã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«`Debug`ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒã‚ã£ã¦ã€

- show AST: æŒ‡å®šã—ãŸãƒ‘ãƒ¼ã‚µãƒ¼ã‹ã‚‰å‡ºåŠ›ã•ã‚Œã‚‹AST
- show comments: ã‚³ãƒ¡ãƒ³ãƒˆãŒASTã«ã©ã†ç´ã¥ã‘ã‚‰ã‚ŒãŸã®ã‹ã®è©³ç´°
- show preprocessed AST: ãã®ASTã«å¯¾ã—ã¦ã€`comments`ã‚’å„ãƒãƒ¼ãƒ‰ã«ç”Ÿã‚„ã—ãŸAST
- show doc: ãã®ASTã‹ã‚‰ç”Ÿæˆã•ã‚ŒãŸDoc

ã¨ã„ã†ã®ã‚’ãã‚Œãã‚Œè¦‹ã‚‰ã‚Œã‚‹ã€‚

ã‚ã‚‰ã‚†ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã¨ã€å³ãƒšã‚¤ãƒ³ãŒ7çª“ã«ãªã£ã¦ãªã‹ãªã‹ã«å£®è¦³ã§ã‚ã‚‹ã€‚

ã‚ã¨ã¯ã€ãƒ‘ãƒ¼ã‚µãƒ¼ã®ä¸­ã‹ã‚‰`doc-explorer`ã¨ã„ã†ã‚‚ã®ã‚’é¸ã¶ã¨ã€Docè‡ªä½“ã‚’è§£æã§ãã‚‹ç‰¹åˆ¥ãªãƒ¢ãƒ¼ãƒ‰ã«ãªã‚‹ã€‚

`const a = 42;`ã‚’å…¥åŠ›ã—ãŸå ´åˆã€ã“ã‚ŒãŒDocã§ã€

```js
[
  group(["const", " ", group([group("a"), " =", " ", "42"]), indent([]), ";"]),
  hardline,
]
```

ã“ã£ã¡ãŒè§£æã•ã‚ŒãŸDocã®ASTã€‚

```js
[
  {
    "type": "group",
    "contents": [
      "const",
      " ",
      {
        "type": "group",
        "contents": [
          {
            "type": "group",
            "contents": "a",
            "break": false
          },
          " =",
          " ",
          "42"
        ],
        "break": false
      },
      {
        "type": "indent",
        "contents": []
      },
      ";"
    ],
    "break": false
  },
  [
    {
      "type": "line",
      "hard": true
    },
    {
      "type": "break-parent"
    }
  ]
]
```

Docã¯JSONã§ã¯ãªããŸã ã®JavaScriptãªã®ã§ã€ã£ã¦æ„Ÿã˜ã‹ã­ã€‚

## CLI

`--help`ã—ã¦ã‚‚å‡ºã¦ã“ãªã„ã‘ã©ã€éš ã—ãƒ•ãƒ©ã‚°ãŒã‚ã‚‹ãƒ»ãƒ»ãƒ»ï¼

> https://github.com/prettier/prettier/blob/52829385bcc4d785e58ae2602c0b098a643523c9/src/cli/cli-options.evaluate.js#L139-L160

- `--debug-benchmark`: ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯å®Ÿè¡Œã—ã¦ãã‚Œã‚‹
- `--debug-check`: 2é‡ã«æ•´å½¢ã—ã¦ã€å·®åˆ†ãŒã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹
- `--debug-print-ast`: æŒ‡å®šã•ã‚ŒãŸãƒ‘ãƒ¼ã‚µãƒ¼ã‹ã‚‰å‡ºåŠ›ã•ã‚Œã‚‹ASTã‚’è¡¨ç¤º
- `--debug-print-comments`: ã‚³ãƒ¡ãƒ³ãƒˆã®ASTã¸ã®ç´ã¥ã‘çµæœã‚’è¡¨ç¤º
- `--debug-print-doc`: Docï¼ˆASTã˜ã‚ƒãªã„ã»ã†ï¼‰ã¸å¤‰æ›ã—ãŸçµæœã‚’è¡¨ç¤º
- `--debug-repeat N`: Nå›å®Ÿè¡Œã—ã¦ã€å¹³å‡å®Ÿè¡Œæ™‚é–“ã‚’å–ã£ã¦ãã‚Œã‚‹

ã„ãã¤ã‹ã®ãƒ•ãƒ©ã‚°ã«ã¤ã„ã¦ã¯ã€`CONTRIBUTING.md`ã«ã‚‚è¨˜è¼‰ãŒã‚ã‚‹ã€‚

> https://github.com/prettier/prettier/blob/3.3.3/CONTRIBUTING.md

ã¡ãªã¿ã«ã€ã“ã‚Œã‚‰ã®ãƒ•ãƒ©ã‚°ã‚’ã•ã°ã„ã¦ã‚‹ã‚³ãƒ¼ãƒ‰ã¯ã“ã®ã¸ã‚“ã€‚

> https://github.com/prettier/prettier/blob/52829385bcc4d785e58ae2602c0b098a643523c9/src/cli/format.js#L110

## API

ã£ã¦ã“ã¨ã¯ã€ç”Ÿã®APIã‚‚ã‚ã‚‹ã‚“ã˜ã‚ƒã‚ï¼Ÿã£ã¦ã“ã¨ã§æ¢ã™ã¨ãƒ“ãƒ³ã‚´ã ã£ãŸã€‚

Playgroundã§ã‚‚ä½¿ã‚ã‚ŒãŸã€‚

> https://github.com/prettier/prettier/blob/3.3.3/website/static/worker.js

é€šå¸¸ç‰ˆã§ã‚‚`standalone`ç‰ˆã§ã‚‚ã€`__debug`ã¨ã„ã†ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã“ã£ãã‚Šå…¬é–‹ã•ã‚Œã¦ã‚‹ã€‚

> https://github.com/prettier/prettier/blob/52829385bcc4d785e58ae2602c0b098a643523c9/src/standalone.js#L39-L45

- `parse(text, options)`: æŒ‡å®šã—ãŸãƒ‘ãƒ¼ã‚µãƒ¼ã§å‡ºåŠ›ã—ãŸASTã¨å…ƒã‚³ãƒ¼ãƒ‰ã‚’è¿”ã™
- `formatAST(ast, options)`: ASTã‚’æ¸¡ã™ã¨æ•´å½¢å¾Œã®æ–‡å­—åˆ—ã‚’è¿”ã™
  - `options.originalText`ãŒç”Ÿãˆã¦ã‚‹ã“ã¨ãŒå¿…é ˆï¼ˆãªã‚“ã§ã‚„ã­ã‚“ï¼‰
- `printToDoc(text, options)`: ASTã‚’æ¸¡ã™ã¨Doc ASTã‚’è¿”ã™
- `formatDoc(doc, options)`: Doc ASTã‚’æ¸¡ã™ã¨Docã‚’è¿”ã™
  - `__js_expression`ã¨ã„ã†å†…éƒ¨çš„ãªãƒ‘ãƒ¼ã‚µãƒ¼ã‚’å¼·åˆ¶çš„ã«ä½¿ç”¨ã™ã‚‹ã‚‰ã—ãã€ãã‚ŒãŒï¼ˆãªãœã‹ï¼‰å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹`babel`ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒå¿…è¦
  - Playgroundã®`doc-explorer`ã®ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã¨åŒã˜å½¢å¼
- `printDocToString(doc, options)`: Doc ASTã‚’æ¸¡ã™ã¨æ•´å½¢å¾Œã®æ–‡å­—åˆ—ã«ã—ã¦è¿”ã™

å…¨éƒ¨ã¾ã¨ã‚ã‚‹ã¨ã“ã†ã„ã†ã‚¤ãƒ¡ãƒ¼ã‚¸ã€‚

```js
import { __debug } from "./standalone.js";
import * as babelPlugin from "./src/plugins/babel.js";
import * as meriyahPlugin from "./src/plugins/meriyah.js";
import * as estreePlugin from "./src/plugins/estree.js";

const plugins = [estreePlugin, babelPlugin, meriyahPlugin];
const source = `
// 1
let a
 = 42 // 2
`.trim();

for (const parser of ["meriyah"]) {
  console.log(`ğŸ¦„ ${parser}`);
  const options = { parser, plugins };

  const parsed = await __debug.parse(source, options);
  console.log(JSON.stringify(parsed, null, 2));

  const f = await __debug.formatAST(parsed.ast, {
    ...options,
    originalText: parsed.text, // ğŸ¤”
  });
  console.log(f);

  const doc = await __debug.printToDoc(source, options);
  console.log(JSON.stringify(doc, null, 2));

  const ff = await __debug.formatDoc(doc, options);
  console.log(ff);

  const fff = await __debug.printDocToString(doc, options);
  console.log(fff.formatted);
}
```

ã¨ã„ã†ã‚ã‘ã§ã€çµå±€ã™ã¹ã¦ã®é“ã¯Docã«é€šãšã‚‹ã®ã§ã‚ã‚‹ãªã‚ã€‚

