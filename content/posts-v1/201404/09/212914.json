{
  "title": "Compassのsprite-mapのlayout: smartでspacingを有効にする",
  "html": "<p>ほんとはこうしたい。</p>\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synIdentifier\">$sprites</span>: sprite-map(<span class=\"synSpecial\">&quot;</span><span class=\"synConstant\">sprite/*.png</span><span class=\"synSpecial\">&quot;</span>, <span class=\"synIdentifier\">$layout</span>: smart, <span class=\"synIdentifier\">$spacing</span>: 8px);\n</pre><p>けど、今のCompassの仕様では、layout: smart の場合、spacing の指定ができません。<br />\nできてもいいと思うけど・・というわけで。</p>\n\n    <blockquote>\n        <p>ちなみに、Compassのバージョンは、0.13です。</p>\n\n    </blockquote>\n\n<div class=\"section\">\n    <h3>有効にする方法</h3>\n    \n<ul>\n<li>本家のモジュールを直接修正する</li>\n<li>本家のモジュールをコンパイル時だけ拡張する</li>\n<li>あきらめて自作のmixinでやる</li>\n</ul><p>調べた限りこんな具合でした。<br />\n最後の1つはもう手に負えない感があるので諦めるとして、ここでは前2つについて。</p>\n\n</div>\n<div class=\"section\">\n    <h3>ここでスプライトの配置を計算してる</h3>\n    <p>現場はこのファイル。</p>\n<pre class=\"code lang-\" data-lang=\"\" data-unlink>PATH/TO/YOUR/COMPASS_DIR/lib/compass/sass_extensions/sprites/layout_methods.rb</pre><p>で、layout: smartのときにrequireされてる</p>\n<pre class=\"code lang-\" data-lang=\"\" data-unlink>PATH/TO/YOUR/COMPASS_DIR/lib/compass/sass_extensions/sprites/layout/smart.rb</pre><p>ここの、 calculate_positions ってのを修正すればよさそう。</p>\n\n</div>\n<div class=\"section\">\n    <h3>どう修正するか</h3>\n    <p>これ見るのが早いです。</p>\n\n    <blockquote>\n        <p>参考: <a href=\"http://stackoverflow.com/questions/16793278/generate-sprites-with-compass-with-smart-layout-and-spacing\" target=\"_blank\" title=\"css3 - Generate sprites with compass with smart layout and spacing - Stack Overflow\">css3 - Generate sprites with compass with smart layout and spacing - Stack Overflow</a></p>\n\n    </blockquote>\n<p>関数名が違うのは、おそらく0.12以前の仕様やからですね。</p><p>これをどうにか反映させればOKぽい！</p>\n\n</div>\n<div class=\"section\">\n    <h3>どう使うか</h3>\n    \n<div class=\"section\">\n    <h4>本家のモジュールを直接修正する</h4>\n    <pre class=\"code lang-\" data-lang=\"\" data-unlink>PATH/TO/YOUR/COMPASS_DIR/lib/compass/sass_extensions/sprites/layout/smart.rb</pre><p>の</p>\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synPreProc\">def</span> <span class=\"synIdentifier\">calculate_positions!</span>\n<span class=\"synComment\"># ...</span>\n<span class=\"synPreProc\">end</span>\n</pre><p>このブロックの実装を、まるっと上記リンクのコードに差し替える。<br />\nそれでもいいけど、できれば本家に手はいれたくないですよねー。</p>\n\n</div>\n<div class=\"section\">\n    <h4>本家のモジュールをコンパイル時だけ拡張する</h4>\n    <p>Compassの設定で、オレオレrubyコードをrequireするオプションがあるのでそれを使う。</p>\n\n<div class=\"section\">\n    <h5>config.rb</h5>\n    <pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synComment\"># layout: smartでspacing使う設定</span>\n<span class=\"synPreProc\">require</span> <span class=\"synSpecial\">'</span><span class=\"synConstant\">path/to/layout_smart_with_spacing_v0.13.rb</span><span class=\"synSpecial\">'</span>\nhttp_path = <span class=\"synSpecial\">&quot;</span><span class=\"synConstant\">/</span><span class=\"synSpecial\">&quot;</span>\ncss_dir = <span class=\"synSpecial\">&quot;</span><span class=\"synConstant\">../_build/css</span><span class=\"synSpecial\">&quot;</span>\n<span class=\"synComment\"># ...</span>\n</pre><p>てな具合に記述。</p>\n\n</div>\n<div class=\"section\">\n    <h5>grunt-contrib-compass</h5>\n    <pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink>options: <span class=\"synIdentifier\">{</span>\n  <span class=\"synComment\">// layout: smartでspacing使う設定</span>\n  require: <span class=\"synConstant\">'path/to/layout_smart_with_spacing_v0.13.rb'</span>,\n  sassDir: <span class=\"synConstant\">'./static/app/style'</span>,\n  <span class=\"synComment\">// ...</span>\n<span class=\"synIdentifier\">}</span>\n</pre><p>grunt派も安心！</p><p>で、肝心のコードは以下。</p><p><script src=\"https://gist.github.com/10263553.js\"> </script><br />\n<a href=\"https://gist.github.com/10263553\">Use layout smart with spacing at compass sprite-ma ...</a></p><br />\n<p>これでちゃんと動くはず。<br />\nPullRequest自体は前々からあるっぽいので、なんしかはよ本家にmergeされてほしいものですねー。</p>\n\n</div>\n</div>\n</div>"
}
