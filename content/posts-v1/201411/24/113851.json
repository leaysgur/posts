{
  "title": "HTML Audioの使い方のまとめ",
  "html": "<p>掘り出し物のメモを記事化して公開していく試み。</p><p>今回はいわゆるaudioタグです。<br />\nいまブラウザで音を出すならどうするのって時の候補ですね。</p><p>いまさらです。<br />\n<br />\n</p>\n\n<div class=\"section\">\n    <h3>Can I use Audio?</h3>\n    \n    <blockquote>\n        <p><a href=\"http://caniuse.com/#feat=audio\" target=\"_blank\" title=\"Can I use... Support tables for HTML5, CSS3, etc\">Can I use... Support tables for HTML5, CSS3, etc</a></p>\n\n    </blockquote>\n<p>最近は割と緑色になってきましたね。<br />\nモバイルでも、Android4以上から使えるという。</p>\n\n</div>\n<div class=\"section\">\n    <h3>とりあえず使う</h3>\n    <p>いちばんカンタンなコードだと。</p>\n<pre class=\"code lang-html\" data-lang=\"html\" data-unlink><span class=\"synIdentifier\">&lt;</span>audio<span class=\"synIdentifier\"> </span><span class=\"synType\">src</span><span class=\"synIdentifier\">=</span><span class=\"synConstant\">&quot;path/to/audio.file&quot;</span><span class=\"synIdentifier\"> autoplay loop&gt;&lt;/</span>audio<span class=\"synIdentifier\">&gt;</span>\n</pre><p>これを書くだけで、ページ読み込み->音声ファイル読み込み->BGMを自動再生->そしてループというお手軽さ。</p>\n\n<div class=\"section\">\n    <h4>属性値</h4>\n    \n<table>\n    <tr>\n    <th>attr</th>\n    <th>value</th>\n    <th>説明</th>\n    </tr>\n    <tr>\n    <td>src</td>\n    <td>String</td>\n    <td>音声ファイルへのパス</td>\n    </tr>\n    <tr>\n    <td>crossorigin</td>\n    <td>anonymous, use-credintialsのどちらか</td>\n    <td>CORSリクエストに認証情報を使用するか、しないか</td>\n    </tr>\n    <tr>\n    <td>preload</td>\n    <td>auto, none, metadataのいずれか</td>\n    <td>プリロードしておくものの指定</td>\n    </tr>\n    <tr>\n    <td>mediagroup</td>\n    <td>String</td>\n    <td>グループ名</td>\n    </tr>\n    <tr>\n    <td>autoplay</td>\n    <td>-</td>\n    <td>自動再生する or NOT</td>\n    </tr>\n    <tr>\n    <td>loop</td>\n    <td>-</td>\n    <td>ループ再生する or NOT</td>\n    </tr>\n    <tr>\n    <td>muted</td>\n    <td>-</td>\n    <td>音声をミュートする or NOT</td>\n    </tr>\n    <tr>\n    <td>controls</td>\n    <td>-</td>\n    <td>再生ボタンやら音量ボリュームやらのUIを表示する or NOT</td>\n    </tr>\n</table>\n</div>\n</div>\n<div class=\"section\">\n    <h3>jsから使う</h3>\n    <pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink><span class=\"synIdentifier\">var</span> audio = <span class=\"synStatement\">new</span> Audio(<span class=\"synConstant\">'path/to/audio.file'</span>);\naudio.loop = <span class=\"synConstant\">true</span>;\naudio.play();\n</pre><p>appendChildしなくても音は鳴ります。</p><p>まあこんな単純な内容なら、特段書くことはないです。</p>\n\n</div>\n<div class=\"section\">\n    <h3>ファイル形式</h3>\n    <p>たとえばmp3は再生できるファイル形式の一部ですが、mp3に対応していない環境もあるかも。<br />\nてな場合にフォールバックできるよう<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%CA%A3%BF%F4\">複数</a>のファイルを指定することができます。</p>\n<pre class=\"code lang-html\" data-lang=\"html\" data-unlink><span class=\"synIdentifier\">&lt;</span>audio<span class=\"synIdentifier\">&gt;</span>\n    <span class=\"synIdentifier\">&lt;</span>source<span class=\"synIdentifier\"> </span><span class=\"synType\">src</span><span class=\"synIdentifier\">=</span><span class=\"synConstant\">&quot;bgm.mp3&quot;</span><span class=\"synIdentifier\">&gt;</span>\n    <span class=\"synIdentifier\">&lt;</span>source<span class=\"synIdentifier\"> </span><span class=\"synType\">src</span><span class=\"synIdentifier\">=</span><span class=\"synConstant\">&quot;bgm.ogg&quot;</span><span class=\"synIdentifier\">&gt;</span>\n    <span class=\"synIdentifier\">&lt;</span><span class=\"synStatement\">p</span><span class=\"synIdentifier\">&gt;</span>対応してません<span class=\"synIdentifier\">&lt;/</span><span class=\"synStatement\">p</span><span class=\"synIdentifier\">&gt;</span>\n<span class=\"synIdentifier\">&lt;/</span>audio<span class=\"synIdentifier\">&gt;</span>\n</pre><p>src属性で指定するのではなく、sourceタグを。</p>\n<pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink><span class=\"synIdentifier\">var</span> audio = <span class=\"synStatement\">new</span> Audio();\naudio.canPlayType(<span class=\"synConstant\">'audio/mpeg'</span>); <span class=\"synComment\">// &quot;probably&quot;</span>\naudio.canPlayType(<span class=\"synConstant\">'audio/mp4'</span>);  <span class=\"synComment\">// &quot;maybe&quot;</span>\naudio.canPlayType(<span class=\"synConstant\">'audio/ogg'</span>);  <span class=\"synComment\">// &quot;maybe&quot;</span>\naudio.canPlayType(<span class=\"synConstant\">'audio/wav'</span>);  <span class=\"synComment\">// &quot;maybe&quot;</span>\n</pre><p>ってすれば使えるものを判定もできる。</p>\n\n</div>\n<div class=\"section\">\n    <h3>実際に使うなら</h3>\n    \n    <blockquote>\n        <p><a href=\"https://developer.mozilla.org/ja/docs/Web/HTML/Supported_media_formats\" target=\"_blank\" title=\"HTML5 の audio 要素と video 要素でサポートされているメディアフォーマット - HTML | MDN\">HTML5 の audio 要素と video 要素でサポートされているメディアフォーマット - HTML | MDN</a></p>\n\n    </blockquote>\n<p>PCならまあ<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/ogg\">ogg</a>/mp4/wavと全部用意しておけば良いかな。<br />\nモバイル相手ならmp4ですよね。<br />\nmp3は商用で使うにはライセンスを料が発生するので、注意したいところ。</p><p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B3%C8%C4%A5%BB%D2\">拡張子</a>と<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/mime\">mime</a>-typeの組み合わせ、端末によっては書き方違うと動かんかったりする・・？</p>\n\n</div>\n<div class=\"section\">\n    <h3>その他の知っとく情報</h3>\n    \n<div class=\"section\">\n    <h4>主にモバイル</h4>\n    \n<ul>\n<li>だいたいの端末で自動再生はできないと思ったほうがいい</li>\n<li>同時再生できるのは1audioまでで、重ねてplayすると先のが止まる</li>\n<li>なので重ねたいならvideoタグも使うか、BGM止めてSE流して即BGM再生みたいにする</li>\n<li>使えるなら素直にWebAudioAPIを</li>\n</ul>\n</div>\n<div class=\"section\">\n    <h4>その他</h4>\n    \n<ul>\n<li>PCならお手軽に使えるので便利</li>\n<li>mutedでautoplayしておいて、ユーザー確認からのmuted解除とか</li>\n<li>連続再生するなら、再生後に<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A4%A5%F3%A5%B9%A5%BF%A5%F3%A5%B9\">インスタンス</a>を初期化しなおしておくが吉</li>\n<li>再生秒数が欲しいならtimeupdateイベントを</li>\n</ul>\n</div>\n</div>"
}
