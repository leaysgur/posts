{
  "title": "サーバーにsftpできないときは",
  "html": "<p>Coda2やForkLiftやTransmitやらなんでもいいけど<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/GUI\">GUI</a>のSftpソフトで、サーバーにつながらんくなった！って時の対処法です。</p><br />\n<p>色んなケースがあるとは思いますが、私の場合はbashrcが悪さしてました。</p>\n\n<div class=\"seemore\">\n    \n<div class=\"section\">\n    <h3>原因と解決方法</h3>\n    \n<div class=\"section\">\n    <h4>原因</h4>\n    <p>bashrcの記述に問題があって、Terminalみたいな「対話型ではない接続」ができなくなってました。</p>\n\n</div>\n<div class=\"section\">\n    <h4>解決方法</h4>\n    <p>ログイン時に読まれるであろうbashrcなどの「先頭」に、</p>\n<pre class=\"code\" data-unlink>[ -z &#34;$PS1&#34; ] &amp;&amp; return</pre><p>と記述してください。<br />\n何をしてるかというと、「対話型ではない接続」の場合は、以降を読み込まないようにしてるだけ。<br />\n普段のTerminalでの接続では、いつも通り読み込まれます。</p>\n\n</div>\n</div>\n<div class=\"section\">\n    <h3>解決までの道のり</h3>\n    \n<div class=\"section\">\n    <h4>Coda2のファイラーが突然つながらんくなった</h4>\n    <p>昨日までいけてたのに！</p><p>Coda2が悪いのかと思い、Forkliftで試す→もちろんダメ。<br />\nううむ。</p><p>ポートの指定もユーザーも<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/ssh\">ssh</a>鍵系も全部問題ないはず。</p>\n\n</div>\n<div class=\"section\">\n    <h4>Terminalからコマンドでつないでみる</h4>\n    <p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/ssh\">ssh</a>はいつも通りできてるけど、sftpは？</p>\n<pre class=\"code\" data-unlink>sftp -oPort=&#34;9999&#34; username@hostname\n# ポートを変えてる場合はポート、username/hostnameはそれぞれのものを。</pre><p>そうすると、</p>\n<pre class=\"code\" data-unlink>Connecting to hostname...\nReceived message too long 1970496800</pre><p>なんかエラーになってるー。</p><p>「Received message too long」で検索するとそれらしい記事が。</p>\n\n    <blockquote>\n        <p>参考：<a href=\"http://d.hatena.ne.jp/boulevard/20090113\" target=\"_blank\" title=\"2009-01-13 - 下手の考え休むに似たり\">2009-01-13 - 下手の考え休むに似たり</a></p>\n\n    </blockquote>\n<p>とはいえ直接の回答ではありませんでした。</p><p>が、bashrcが怪しいということがわかって、メッセージ・・もしや<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/GUI\">GUI</a>系のソフトでログインしたらダメなやつとかあったり・・？と思ったので。</p>\n\n</div>\n<div class=\"section\">\n    <h4>bashrcが悪かった</h4>\n    <p>bashrcをリネームして読み込まれないようにして試したところ、あっさりつながるじゃないの！</p><p>ということは、どうやらつい最近覚えたbashrcのカスタマイズの影響だった模様。<br />\nbashrcの先頭に以下を追記。</p>\n<pre class=\"code\" data-unlink># .bashrc for interactive terminal\n[ -z &#34;$PS1&#34; ] &amp;&amp; return</pre><p>「対話型の接続」の場合に定義される<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B4%C4%B6%AD%CA%D1%BF%F4\">環境変数</a> PS1 がない場合は、何も読み込まないように設定。<br />\nこれですっきり解決。</p>\n\n    <blockquote>\n        <p>やっぱ<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Linux\">Linux</a>もとい<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/bash\">bash</a>をきっちりやらなあかんのかしら・・</p>\n\n    </blockquote>\n\n</div>\n</div>\n</div>"
}
