{
  "title": "Perlのワンライナーでテキストの一括置換",
  "html": "<p>職場の諸先輩方の影響を受け、Terminal.appからiTerm2に乗り換えました。<br />\nコレ良い！ってなった点は、カラースキームがエクスポートできて、複数台で使いまわせる点と、範囲選択＝クリップボードにコピーくらいですが・・。</p><p>というわけで、黒い画面でできることは黒い画面でやろう！のモットーの元、今回はPerlのワンライナーを勉強します。</p>\n\n<div class=\"seemore\">\n    \n<div class=\"section\">\n    <h3>ワンライナー</h3>\n    <p>プログラミング言語のPerlですが、コマンドラインからも実行できます。</p>\n<pre class=\"code\" data-unlink>perl -e &#39;print &#34;Hello One Liner!\\n&#34;&#39;\n# Hello One Liner!</pre><p>みたいな感じです。<br />\nコマンドの引数として1行(OneLine)の短いスクリプトを書ける！ってやつなんですね。<br />\nそれに、文字を置換する</p>\n<pre class=\"code\" data-unlink><span class=\"synStatement\">s/</span><span class=\"synConstant\">hoge</span><span class=\"synStatement\">/</span><span class=\"synConstant\">fuga</span><span class=\"synStatement\">/g</span>\n</pre><p>のような正規表現の置換を組み合わせようという魂胆です。</p>\n\n<div class=\"section\">\n    <h4>やりたかったこと</h4>\n    <pre class=\"code\" data-unlink>ack -al &#39;nyan&#39; | xargs perl -pi -e &#39;s/nyan/PIYO/g&#39;</pre><p>\"nyan\"という文字列が含まれるファイル内の、\"nyan\"をすべて\"PIYO\"に置換します。<br />\nクラス名やプロパティの一括置換とかに使えます。</p><p>ファイル名がわかってる場合は、</p>\n<pre class=\"code\" data-unlink>perl -pi -e &#39;s/nyan/PIYO/g&#39; hoge.html</pre><p>とかでも良いです。</p>\n\n</div>\n</div>\n<div class=\"section\">\n    <h3>xargs</h3>\n    <p>しれっと書いてますが、先に実行したコマンドの結果を、その後につないだコマンドの引数にできるってやつです。<br />\n概念的には、</p>\n<pre class=\"code\" data-unlink>perl -pi -e &#39;s/nyan/piyo/g&#39; [fileName(s)]</pre><p>このファイル名の引数の部分に、</p>\n<pre class=\"code\" data-unlink>ack -al &#39;nyan&#39;</pre><p>の結果を渡して実行することになります。<br />\nこのackコマンドとlオプションでは、ファイル名のリストが返ってくるので、この使い方にはぴったりでした。</p>\n\n</div>\n<div class=\"section\">\n    <h3>perlコマンドのオプションについて</h3>\n    <p>今回の例において必要なオプションは以下の通り。</p>\n\n<ul>\n<li>pをつけないと、出力結果が出ない＝ファイルが変更されない</li>\n<li>iをつけないと、出力結果がファイルに返らない(pのおかげで標準出力には出る</li>\n<li>eをつけないと、文字がスクリプトとして認識されない(ワンライナーにならない</li>\n</ul><pre class=\"code\" data-unlink>ack -al &#39;nyan&#39; | xargs perl -pi -e &#39;s/nyan/PIYO/g&#39;</pre><p>っていう今回のワンライナーですが、そもそも、</p>\n<pre class=\"code\" data-unlink>ack -al &#39;nyan&#39; | xargs perl -pie &#39;s/nyan/PIYO/g&#39;</pre><p>なんでこうできないの？って思いました。<br />\nオプションってひとまとめにできないもんかね？と。</p><p>でも、やってみると、</p>\n<pre class=\"code\" data-unlink>Can&#39;t open perl script &#34;s/fuga/PIYO/g&#34;: No such file or directory</pre><p>eオプションをつけずにperlコマンドを実行した場合、第一引数はスクリプトと解釈されるらしい。(付けたつもりやったけど<br />\nというわけで、オプションにも色々あって、独立して指定しないといけないオプションもいるんですね。</p>\n\n    <blockquote>\n        <p>さらにちなみに、オプションの順番を変えてもダメです。eオプションの直後にスクリプト文字列！これが大事。</p>\n\n    </blockquote>\n\n</div>\n<div class=\"section\">\n    <h3>おわりに</h3>\n    <p>厳密なパフォーマンス的な観点からいうと、xargsは使わない方が良いとも聞きます。<br />\nじゃあどうすれば良いのってのが今はわからないので、しばらくはコレでやってみようと思います。</p><p>ワンライナーのワくらいしか使えてない感はありますが、これできるだけでだいぶ楽なので良しとしますｗ<br />\nPerlって便利ですねー。</p>\n\n</div>\n</div>"
}
