{
  "title": "img src=\"\" で無駄リクエストが飛ぶ問題",
  "html": "<p>どうなるかっていうのと、どうすればいいかっていうのをメモ。</p>\n\n    <blockquote>\n        <p><s>古いAndroidの特定端末で起こったりするのですが、<br />\nこのバグ、最近のブラウザではもう解消されてるのかしら？</s><br />\nコメントで頂きましたが、依然として起きるみたいです・・。</p>\n\n    </blockquote>\n\n<div class=\"section\">\n    <h3>srcが空だと</h3>\n    <p>以下のケース。</p>\n<pre class=\"code lang-html\" data-lang=\"html\" data-unlink><span class=\"synIdentifier\">&lt;</span><span class=\"synStatement\">img</span><span class=\"synIdentifier\"> </span><span class=\"synType\">src</span><span class=\"synIdentifier\">=</span><span class=\"synConstant\">&quot;&quot;</span><span class=\"synIdentifier\">&gt;</span>\n</pre><p>この場合、srcは勝手にそのページのルートへアクセスしてしまって、無駄なリクエストが発生していまいます。(いかなる状況でもそうなるわけではないみたいやけど)</p>\n\n</div>\n<div class=\"section\">\n    <h3>それを回避するには</h3>\n    <p>調べてみた限り、以下の3パターンが多かったです。</p>\n\n<div class=\"section\">\n    <h4>//:0</h4>\n    <pre class=\"code lang-html\" data-lang=\"html\" data-unlink><span class=\"synIdentifier\">&lt;</span><span class=\"synStatement\">img</span><span class=\"synIdentifier\"> </span><span class=\"synType\">src</span><span class=\"synIdentifier\">=</span><span class=\"synConstant\">&quot;//:0&quot;</span><span class=\"synIdentifier\">&gt;</span>\n</pre><p>これはすごいなーと思いました。</p>\n\n    <blockquote>\n        <p>参考：<a href=\"http://stackoverflow.com/questions/5775469/whats-the-valid-way-to-include-an-image-with-no-src\" target=\"_blank\" title=\"html - What&apos;s the valid way to include an image with no src? - Stack Overflow\">html - What&apos;s the valid way to include an image with no src? - Stack Overflow</a></p>\n\n    </blockquote>\n<p>ただコレ、一部のAndroidで無理くり画像を読み込もうとするやつがいて・・。<br />\n後からsrcを差し替えても、最初のいわゆる「壊れたブランク画像みたいな表示」が焼け付いて、<br />\n後から差し替えた画像のまわりに謎の枠が現れたりするケースがあります。</p>\n\n</div>\n<div class=\"section\">\n    <h4>about:blank</h4>\n    <pre class=\"code lang-html\" data-lang=\"html\" data-unlink><span class=\"synIdentifier\">&lt;</span><span class=\"synStatement\">img</span><span class=\"synIdentifier\"> </span><span class=\"synType\">src</span><span class=\"synIdentifier\">=</span><span class=\"synConstant\">&quot;about:blank&quot;</span><span class=\"synIdentifier\">&gt;</span>\n</pre><p>こんなのでもいいんですね。<br />\nそう、Chromeでお馴染みの、です。<br />\nINVALIDなHTMLになるからイヤ勢が割とおる模様。</p>\n\n</div>\n<div class=\"section\">\n    <h4>1x1pxのgifをbase64エンコードしたもの</h4>\n    <pre class=\"code lang-html\" data-lang=\"html\" data-unlink><span class=\"synIdentifier\">&lt;</span><span class=\"synStatement\">img</span><span class=\"synIdentifier\"> </span><span class=\"synType\">src</span><span class=\"synIdentifier\">=</span><span class=\"synConstant\">&quot;data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7&quot;</span><span class=\"synIdentifier\">&gt;</span>\n<span class=\"synIdentifier\">&lt;</span><span class=\"synStatement\">img</span><span class=\"synIdentifier\"> </span><span class=\"synType\">src</span><span class=\"synIdentifier\">=</span><span class=\"synConstant\">&quot;data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=&quot;</span><span class=\"synIdentifier\">&gt;</span>\n</pre><p>上のが透明、下のが真っ黒。</p><p>なにとはいいませんが、URLライクな文字列がsrcタグに指定されてた場合に、独自の解釈でパスを置換するようなフレームワークがありまして。</p><p>そういうケースでは、上記2パターンが通用しないです。<br />\nそんな場合は諦めて、なるべく軽い画像を使おう、と。</p><p>まあ、いっぺんやってみてあかんかったら対応する、でいいやね。</p>\n\n</div>\n</div>"
}
