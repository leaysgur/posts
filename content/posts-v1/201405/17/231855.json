{
  "title": "Gruntでディレクトリごとwatchしつつ、更新されたファイルだけにアレするには",
  "html": "<p>アレはアレです。</p><p>それGruntでもできるよ！！<br />\nGulpだなんだ言う前に、もっとちゃんとGrunt使わなきゃなと思いました。<br />\n<br />\n</p>\n\n<div class=\"section\">\n    <h3>Gruntfile.js</h3>\n    <pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink><span class=\"synComment\">//...</span>\n  <span class=\"synComment\">// いわゆるビルドの直前にやるみたく、何も気にせず全部をターゲットにしておく</span>\n  jshint: <span class=\"synIdentifier\">{</span>\n    files: <span class=\"synIdentifier\">[</span><span class=\"synConstant\">'/path/to/my/targets/**/*.js'</span><span class=\"synIdentifier\">]</span>,\n    options: <span class=\"synIdentifier\">{</span>\n      jshintrc: <span class=\"synConstant\">'/path/to/my/.jshintrc'</span>\n    <span class=\"synIdentifier\">}</span>\n  <span class=\"synIdentifier\">}</span>,\n  <span class=\"synComment\">// こちらも同じく</span>\n  copy: <span class=\"synIdentifier\">{</span>\n    main: <span class=\"synIdentifier\">{</span>\n      cwd: <span class=\"synConstant\">'..'</span>,\n      src: <span class=\"synConstant\">'**'</span>,\n      dest: <span class=\"synConstant\">'/path/to/dest/dir'</span>,\n      expand: <span class=\"synConstant\">true</span>\n    <span class=\"synIdentifier\">}</span>\n  <span class=\"synIdentifier\">}</span>,\n  esteWatch: <span class=\"synIdentifier\">{</span>\n    options: <span class=\"synIdentifier\">{</span>\n      dirs: <span class=\"synIdentifier\">[</span>\n        <span class=\"synConstant\">'/path/to/js/**/'</span>,\n        <span class=\"synConstant\">'/path/to/css/**/'</span>\n      <span class=\"synIdentifier\">]</span>,\n      livereload: <span class=\"synIdentifier\">{</span>\n        enabled: <span class=\"synConstant\">false</span>\n      <span class=\"synIdentifier\">}</span>\n    <span class=\"synIdentifier\">}</span>,\n    js: <span class=\"synIdentifier\">function</span>(filepath) <span class=\"synIdentifier\">{</span>\n      <span class=\"synComment\">// 変更あったファイルだけjshint</span>\n      grunt.config(<span class=\"synIdentifier\">[</span><span class=\"synConstant\">'jshint'</span>, <span class=\"synConstant\">'files'</span><span class=\"synIdentifier\">]</span>, filepath);\n      <span class=\"synStatement\">return</span> <span class=\"synIdentifier\">[</span><span class=\"synConstant\">'jshint'</span><span class=\"synIdentifier\">]</span>;\n    <span class=\"synIdentifier\">}</span>,\n    css: <span class=\"synIdentifier\">function</span>(filepath) <span class=\"synIdentifier\">{</span>\n      <span class=\"synComment\">// 変更あったファイルだけcopy</span>\n      grunt.config(<span class=\"synIdentifier\">[</span><span class=\"synConstant\">'copy'</span>, <span class=\"synConstant\">'main'</span>, <span class=\"synConstant\">'src'</span><span class=\"synIdentifier\">]</span>, filepath);\n      <span class=\"synStatement\">return</span> <span class=\"synIdentifier\">[</span><span class=\"synConstant\">'copy'</span><span class=\"synIdentifier\">]</span>;\n    <span class=\"synIdentifier\">}</span>\n  <span class=\"synIdentifier\">}</span>;\n<span class=\"synComment\">//...</span>\n</pre>\n</div>\n<div class=\"section\">\n    <h3>ポイント</h3>\n    <pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink>js: <span class=\"synIdentifier\">function</span>(filepath) <span class=\"synIdentifier\">{</span>\n  <span class=\"synComment\">// 変更あったファイルだけjshint</span>\n  grunt.config(<span class=\"synIdentifier\">[</span><span class=\"synConstant\">'jshint'</span>, <span class=\"synConstant\">'files'</span><span class=\"synIdentifier\">]</span>, filepath);\n  <span class=\"synComment\">// その設定でタスク実行</span>\n  <span class=\"synStatement\">return</span> <span class=\"synIdentifier\">[</span><span class=\"synConstant\">'jshint'</span><span class=\"synIdentifier\">]</span>;\n<span class=\"synIdentifier\">}</span>\n</pre><p>grunt.configでもって、本来のタスクに設定されたプロパティを上書きして、タスクを実行。<br />\nそうすれば更新されたファイル単品だけでタスクを実行することができるという。</p>\n\n<div class=\"section\">\n    <h4>grunt.config</h4>\n    <pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink><span class=\"synComment\">// 第一引数のみの場合は、grunt.config.get()と同じ</span>\ngrunt.config(<span class=\"synConstant\">'jshint'</span>);\n<span class=\"synComment\">// 第一引数は単品でも配列でもOK</span>\ngrunt.config(<span class=\"synIdentifier\">[</span><span class=\"synConstant\">'jshint'</span><span class=\"synIdentifier\">]</span>);\n<span class=\"synComment\">// 第一引数で深く攻めるなら配列になるやね</span>\ngrunt.config(<span class=\"synIdentifier\">[</span><span class=\"synConstant\">'jshint'</span>, <span class=\"synConstant\">'files'</span><span class=\"synIdentifier\">]</span>, filepath);\n\n<span class=\"synComment\">// 第二引数がつくと、grunt.config.set()と同じ</span>\ngrunt.config(<span class=\"synConstant\">'jshint'</span>, <span class=\"synIdentifier\">{</span> files: <span class=\"synIdentifier\">[</span><span class=\"synConstant\">'/hoge/*.js'</span><span class=\"synIdentifier\">]</span> <span class=\"synIdentifier\">}</span>);\n</pre><p>これはべんりー。</p>\n\n</div>\n</div>"
}
