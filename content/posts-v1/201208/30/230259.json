{
  "title": "scrollToの挙動について",
  "html": "<p>JavaScriptを書くコトはまだ仕事ではないのですが、少しずつできるようになれたらいいなぁと思いつつ。<br />\n他人のコードを真っ当に盗み見できるのは良いことですね。←もはや盗み見でもなんでもないｗ</p><p>で、scrollTo関数の挙動について気になる点＋ハマった点があったのでメモ。</p>\n\n<div class=\"seemore\">\n    \n<div class=\"section\">\n    <h3>スマートフォンでアドレスバーを隠す処理</h3>\n    <p>よくあるやつです。</p>\n<pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink><span class=\"synIdentifier\">var</span> hideAddressBar = <span class=\"synIdentifier\">function</span>()<span class=\"synIdentifier\">{</span>\n\tsetTimeout(<span class=\"synIdentifier\">function</span>()<span class=\"synIdentifier\">{</span>\n\t\t<span class=\"synStatement\">window</span>.scrollTo(0, 1);\n\t<span class=\"synIdentifier\">}</span>, 100);\n<span class=\"synIdentifier\">}</span>;\n\n<span class=\"synStatement\">document</span>.addEventListener(<span class=\"synConstant\">'DOMContentLoaded'</span>, hideAddressBar, <span class=\"synConstant\">false</span>);\n</pre><p>setTimeoutはなくても良い気はしますが、あった方がより多くの機種・環境にそれっぽく対応できるとのこと。<br />\nなんか読み込み遅い機種とかあるらしい。</p><p>読み込まれた画面を、無理やりスクロールさせて、アドレスバーを引っ込ませるんですね。</p><p>で、さもありなライブラリだと、これを汎用的に記述してたりします。</p>\n\n</div>\n<div class=\"section\">\n    <h3>より汎用的な関数に</h3>\n    <p>こんな具合に。</p>\n<pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink><span class=\"synIdentifier\">var</span> scrollHandler = <span class=\"synIdentifier\">function</span>(x, y, t)<span class=\"synIdentifier\">{</span>\n\tsetTimeout(<span class=\"synIdentifier\">function</span>()<span class=\"synIdentifier\">{</span>\n\t\t<span class=\"synStatement\">window</span>.scrollTo(x || 0, y || 1);\n\t<span class=\"synIdentifier\">}</span>, t || 100);\n<span class=\"synIdentifier\">}</span>;\n\n<span class=\"synStatement\">document</span>.addEventListener(<span class=\"synConstant\">'DOMContentLoaded'</span>, scrollHandler, <span class=\"synConstant\">false</span>);\n\n<span class=\"synComment\">// clickでも使える！汎用的っしょ！</span>\nelem.addEventListener(<span class=\"synConstant\">'click'</span>, scrollHandler(0, 200, 0), <span class=\"synConstant\">false</span>);\n</pre>\n</div>\n<div class=\"section\">\n    <h3>そしてハマる(本題)</h3>\n    <p>今回メモしておきたかったのは、</p>\n\n    <blockquote>\n        <p>このscrollTo関数に対して数値以外が渡されるとどうなるか</p>\n\n    </blockquote>\n<p>です。</p><p>結論から書くと、</p>\n\n    <blockquote>\n        <p>「数値(として解釈できそうにない)値は、0として扱われる」</p>\n\n    </blockquote>\n<p>みたいです。<br />\n(実際そうなってるのか、たまたま同じ挙動なのか、わからないので、「みたい」ですにとどめてます・・。)</p><p>上述した汎用的なコードは、実はこんな挙動になってます。</p>\n<pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink><span class=\"synIdentifier\">var</span> scrollHandler = <span class=\"synIdentifier\">function</span>(x, y, t)<span class=\"synIdentifier\">{</span>\n\t<span class=\"synComment\">// xにclickのイベントオブジェクト、その他にはundefinedが渡される</span>\n\tsetTimeout(<span class=\"synIdentifier\">function</span>()<span class=\"synIdentifier\">{</span>\n\t\t<span class=\"synStatement\">window</span>.scrollTo(x || 0, y || 1); <span class=\"synComment\">// Event, 1</span>\n\t<span class=\"synIdentifier\">}</span>, t || 100); <span class=\"synComment\">// undefinedのため100</span>\n<span class=\"synIdentifier\">}</span>;\n\n<span class=\"synStatement\">document</span>.addEventListener(<span class=\"synConstant\">'DOMContentLoaded'</span>, scrollHandler, <span class=\"synConstant\">false</span>);\n<span class=\"synComment\">// 100㍉秒後に、scrollTo(Event, 1)を実行</span>\n<span class=\"synComment\">// Eventってなんやねん！てことで0扱い</span>\n</pre>\n</div>\n<div class=\"section\">\n    <h3>scrollTo関数にいろいろ渡してみる</h3>\n    <p>この関数には数値しか渡させないと思ってましたが、いろいろ渡してみると意外に動いた。<br />\nエラーになってくれれば良いのに・・・。</p><p>以下はテスト結果です。</p>\n\n<table>\n    <tr>\n    <th>No.</th>\n    <th>引数</th>\n    <th>typeof</th>\n    <th>挙動</th>\n    <th>備考</th>\n    </tr>\n    <tr>\n    <td>01</td>\n    <td>10</td>\n    <td>number</td>\n    <td>scrollTo(100, 1)</td>\n    <td>数値扱い</td>\n    </tr>\n    <tr>\n    <td>02</td>\n    <td>'10'</td>\n    <td>string</td>\n    <td>scrollTo(100, 1)</td>\n    <td>数値扱い</td>\n    </tr>\n    <tr>\n    <td>03</td>\n    <td>true</td>\n    <td>boolean</td>\n    <td>scrollTo(0, 1)</td>\n    <td> </td>\n    </tr>\n    <tr>\n    <td>04</td>\n    <td>Event</td>\n    <td>object</td>\n    <td>scrollTo(0, 1)</td>\n    <td> </td>\n    </tr>\n    <tr>\n    <td>05</td>\n    <td>[100,10]</td>\n    <td>object</td>\n    <td>scrollTo(0, 1)</td>\n    <td> </td>\n    </tr>\n    <tr>\n    <td>06</td>\n    <td>[100]</td>\n    <td>object</td>\n    <td>scrollTo(100, 1)</td>\n    <td>数値扱い</td>\n    </tr>\n    <tr>\n    <td>07</td>\n    <td>{x:100,y:100}</td>\n    <td>object</td>\n    <td>scrollTo(0, 1)</td>\n    <td> </td>\n    </tr>\n    <tr>\n    <td>08</td>\n    <td>function(){}</td>\n    <td>function</td>\n    <td>scrollTo(0, 1)</td>\n    <td> </td>\n    </tr>\n    <tr>\n    <td>09</td>\n    <td>null</td>\n    <td>object</td>\n    <td>scrollTo(0, 1)</td>\n    <td> </td>\n    </tr>\n    <tr>\n    <td>10</td>\n    <td>undefined</td>\n    <td>undefined</td>\n    <td>scrollTo(0, 1)</td>\n    <td> </td>\n    </tr>\n</table>\n<div class=\"section\">\n    <h4>テストしたコード</h4>\n    <p>よかったら試してみてくださいな。<br />\n<script type=\"text/javascript\" src=\"http://jsdo.it/blogparts/pmVv/js?width=465&height=496&view=javascript\"></script></p><p>JavaScript挙動不審すぎるわー。<br />\nハマったというより、釈然としない気持ちの悪い感じですねｗ</p><p>どなたか解説してください・・。</p>\n\n</div>\n</div>\n</div>"
}
