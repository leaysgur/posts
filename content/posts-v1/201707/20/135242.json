{
  "title": "Flowでコンストラクタをエクスポートするモジュールの型を定義する",
  "html": "<p>こういうやつ。</p>\n<pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink><span class=\"synStatement\">import</span> EventEmitter from <span class=\"synConstant\">'events'</span>;\n\n<span class=\"synStatement\">const</span> ee = <span class=\"synStatement\">new</span> EventEmitter(); <span class=\"synComment\">// &lt;- コレ</span>\n</pre><p>これはあくまで例で、Node標準の`events`のEventEmitterなら、Flowがビルトインで型情報を持ってるので困りません。<br />\nでも似たようなのを自分で書いたり、他のライブラリに型をつける場合に必要になるはず。</p>\n\n<div class=\"section\">\n    <h3>こう書く</h3>\n    <pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink>declare module <span class=\"synConstant\">'events'</span> <span class=\"synIdentifier\">{</span>\n  declare <span class=\"synStatement\">class</span> EventEmitter <span class=\"synIdentifier\">{</span>\n  <span class=\"synIdentifier\">}</span>\n\n  declare <span class=\"synIdentifier\">var</span> exports: <span class=\"synStatement\">typeof</span> EventEmitter;\n<span class=\"synIdentifier\">}</span>\n</pre>\n    <blockquote>\n        <p><a href=\"https://github.com/facebook/flow/issues/769\">Is there a way to tell Flow an exported module _is_ a class? &middot; Issue #769 &middot; facebook/flow &middot; GitHub</a></p>\n\n    </blockquote>\n<p>ちなみに、こういう書き方で迷ったら、flow-typedを適当に眺めると見つかったりもする。</p>\n\n    <blockquote>\n        <p><a href=\"https://github.com/flowtype/flow-typed\">GitHub - flowtype/flow-typed: A central repository for Flow library definitions</a></p>\n\n    </blockquote>\n<p>相変わらず公開されてるモジュールは少ない・・・( ˘ω˘)</p>\n\n</div>\n<div class=\"section\">\n    <h3>ふつうにエクスポートしたい場合</h3>\n    <pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink>declare module <span class=\"synConstant\">'my-module'</span> <span class=\"synIdentifier\">{</span>\n  declare module.exports: <span class=\"synIdentifier\">{</span>\n    foo(): void;\n    bar(baz: number): <span class=\"synStatement\">boolean</span>;\n  <span class=\"synIdentifier\">}</span>\n<span class=\"synIdentifier\">}</span>\n\n<span class=\"synComment\">// or</span>\n\ndeclare module <span class=\"synConstant\">'my-module'</span> <span class=\"synIdentifier\">{</span>\n  declare <span class=\"synIdentifier\">function</span> foo(): void;\n  declare <span class=\"synIdentifier\">function</span> bar(baz: number): <span class=\"synStatement\">boolean</span>;\n<span class=\"synIdentifier\">}</span>\n</pre><p>ってすれば動く。</p>\n\n    <blockquote>\n        <p><a href=\"https://flow.org/en/docs/libdefs/creation/#toc-declaring-a-module\">Creating Library Definitions | Flow</a></p>\n\n    </blockquote>\n\n</div>\n<div class=\"section\">\n    <h3>ちなみにDefault + Namedエクスポートしたい場合</h3>\n    <pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink>declare module <span class=\"synConstant\">'socket.io-client'</span> <span class=\"synIdentifier\">{</span>\n  declare <span class=\"synStatement\">class</span> IOSocket <span class=\"synIdentifier\">{</span>\n    connected: <span class=\"synStatement\">boolean</span>;\n    on(eventName: string, callback: (*) =&gt; *): void;\n    emit(eventName: string, ...args: *<span class=\"synIdentifier\">[]</span>): void;\n    connect(): void;\n    disconnect(): void;\n  <span class=\"synIdentifier\">}</span>\n\n  declare <span class=\"synStatement\">export</span> <span class=\"synStatement\">default</span> (url: string, options?: <span class=\"synType\">Object</span>) =&gt; IOSocket;\n  declare <span class=\"synStatement\">export</span> <span class=\"synIdentifier\">var</span> IOSocket: <span class=\"synStatement\">typeof</span> IOSocket;\n<span class=\"synIdentifier\">}</span>\n</pre><p>みたいにすれば、</p>\n<pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink><span class=\"synStatement\">import</span> io from <span class=\"synConstant\">'socket.io-client'</span>;\n<span class=\"synStatement\">import</span> type <span class=\"synIdentifier\">{</span> IOSocket <span class=\"synIdentifier\">}</span> from <span class=\"synConstant\">'socket.io-client'</span>;\n\n<span class=\"synStatement\">const</span> socket: IOSocket = io(url);\n</pre><p>ってできる。</p><br />\n<p>このへんまじで正解がわからん・・。</p>\n\n</div>"
}
