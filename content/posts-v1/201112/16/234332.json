{
  "title": "jQuery.ajaxでjsonがうまく取得できない時は",
  "html": "<p>何回やっても取得できない！<br />\njsonの形式も間違ってないし、メソッドも間違えてないはずやのに、なんでや！</p><p>そしてミスに気づいた・・その顛末を。</p><p>とっても初歩的なミスなので、備忘録として！</p>\n\n    <blockquote>\n        <p>かなり古い記事なので、$.ajax().then()とか今風の書き方にはなってないですが、本質的にはまだ通用するっぽいのでそこだけ見てください！</p>\n\n    </blockquote>\n\n<div class=\"section\">\n    <h3>ダメだったケース</h3>\n    <pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink>$(<span class=\"synIdentifier\">function</span>()<span class=\"synIdentifier\">{</span>\n  $.ajax(<span class=\"synIdentifier\">{</span>\n    type: <span class=\"synConstant\">&quot;GET&quot;</span>,\n    scriptCharset: <span class=\"synConstant\">'utf-8'</span>,\n    url: <span class=\"synConstant\">&quot;sample.json&quot;</span>,\n    success: <span class=\"synIdentifier\">function</span>(res)<span class=\"synIdentifier\">{</span>\n      console.debug(res<span class=\"synIdentifier\">[</span>0<span class=\"synIdentifier\">]</span>); <span class=\"synComment\">//こいつがイマイチおかしい</span>\n    <span class=\"synIdentifier\">}</span>,\n    error:<span class=\"synIdentifier\">function</span>()<span class=\"synIdentifier\">{</span>console.log(<span class=\"synConstant\">'Miss..'</span>);<span class=\"synIdentifier\">}</span>\n  <span class=\"synIdentifier\">}</span>);\n<span class=\"synIdentifier\">}</span>);\n</pre><p>ちゃんと変なものが返ってくるので、何がおかしいんやろうかと。</p><p>Why!!</p>\n\n</div>\n<div class=\"section\">\n    <h3>こうしたら動いた</h3>\n    <pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink>$(<span class=\"synIdentifier\">function</span>()<span class=\"synIdentifier\">{</span>\n  $.ajax(<span class=\"synIdentifier\">{</span>\n    type: <span class=\"synConstant\">&quot;GET&quot;</span>,\n    scriptCharset: <span class=\"synConstant\">'utf-8'</span>,\n    url: <span class=\"synConstant\">&quot;sample.json&quot;</span>,\n    success: <span class=\"synIdentifier\">function</span>(res)<span class=\"synIdentifier\">{</span>\n      res = $.parseJSON(res);\n      console.debug(res<span class=\"synIdentifier\">[</span>0<span class=\"synIdentifier\">]</span>); <span class=\"synComment\">//こうやったら動いた！</span>\n    <span class=\"synIdentifier\">}</span>,\n    error:<span class=\"synIdentifier\">function</span>()<span class=\"synIdentifier\">{</span>console.log(<span class=\"synConstant\">'Miss..'</span>);<span class=\"synIdentifier\">}</span>\n  <span class=\"synIdentifier\">}</span>);\n<span class=\"synIdentifier\">}</span>);\n</pre><p>.parseJSON()したらOKになった！わーい。<br />\nって、なんかこの一手間・・・ムダじゃないかなーと・・。</p>\n\n</div>\n<div class=\"section\">\n    <h3>そして気づく</h3>\n    <pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink>$(<span class=\"synIdentifier\">function</span>()<span class=\"synIdentifier\">{</span>\n  $.ajax(<span class=\"synIdentifier\">{</span>\n    type: <span class=\"synConstant\">&quot;GET&quot;</span>,\n    scriptCharset: <span class=\"synConstant\">'utf-8'</span>,\n    dataType:<span class=\"synConstant\">'json'</span>, <span class=\"synComment\">// コレを忘れてた！！</span>\n    url: <span class=\"synConstant\">&quot;sample.json&quot;</span>,\n    success: <span class=\"synIdentifier\">function</span>(res)<span class=\"synIdentifier\">{</span>\n      console.debug(res<span class=\"synIdentifier\">[</span>0<span class=\"synIdentifier\">]</span>); <span class=\"synComment\">//ばっちり読み込み成功！</span>\n    <span class=\"synIdentifier\">}</span>,\n    error:<span class=\"synIdentifier\">function</span>()<span class=\"synIdentifier\">{</span>console.log(<span class=\"synConstant\">'Miss..'</span>);<span class=\"synIdentifier\">}</span>\n  <span class=\"synIdentifier\">}</span>);\n<span class=\"synIdentifier\">}</span>);\n</pre><p>今コレを書いてて、なんでこんな凡ミスを・・って思いましたが、<br />\n「jQueryの.ajaxで何回jsonを取得してもundifinedとか変なのしか返ってこない！！」って方、<br />\ndataType忘れてませんか？ということで。</p>\n\n    <blockquote>\n        <p>参考：<a href=\"http://api.jquery.com/jQuery.ajax/\" target=\"_blank\" title=\"jQuery.ajax() – jQuery API\">jQuery.ajax() – jQuery API</a></p>\n\n    </blockquote>\n<p>他にもいーっぱいパラメータがあるので、ちゃんと確認しないとですね！</p>\n\n<div class=\"section\">\n    <h4>ちなみに</h4>\n    <p>jsonの内容がおかしいかも・・って時に、便利なサイトがありました。</p>\n\n    <blockquote>\n        <p>参考：<a href=\"http://jsonlint.com/\" target=\"_blank\" title=\"JSONLint - The JSON Validator.\">JSONLint - The JSON Validator.</a></p>\n\n    </blockquote>\n\n</div>\n</div>"
}
