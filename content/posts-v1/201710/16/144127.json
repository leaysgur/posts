{
  "title": "iOS SafariのカメラストリームをChromeにWebRTCで送ってMediaRecorderでWebMにするとおかしな動画が撮れる",
  "html": "<p>またもニッチなケースを踏みましたというメモです。<br />\n<br />\n</p>\n\n<div class=\"section\">\n    <h3>経緯</h3>\n    <p>弊社の開発合宿で作ろうとしてたものが（正確にはいまも合宿中なのでing）あります。</p>\n\n<ul>\n<li>iOS Safariで`getUserMedia()`</li>\n<li>WebRTCで飛ばす</li>\n<li>PCのChromeで受け取る</li>\n<li>MediaRecorderで`.webm`に</li>\n</ul><p>ざっくりこんな感じ。<br />\n本当にやりたかった要件はまだ続きがあるけど、とりあえず問題に必要な手順がコレ。</p>\n\n</div>\n<div class=\"section\">\n    <h3>おかしな動画</h3>\n    <p><blockquote class=\"twitter-tweet\" data-lang=\"en\"><p lang=\"ja\" dir=\"ltr\">こういう風になる<a href=\"https://t.co/j2LQe3PBA3\">https://t.co/j2LQe3PBA3</a> <a href=\"https://t.co/OqzaYOr3CX\">pic.twitter.com/OqzaYOr3CX</a></p>&mdash; りぃ (@leader22) <a href=\"https://twitter.com/leader22/status/919794669373894656?ref_src=twsrc%5Etfw\">October 16, 2017</a></blockquote> <script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script> </p><p>こんなん。</p><p>iOS Safariから飛んでくるストリームは縦長なのに、そのままの縦長ではなくこのようにアス比1の領域を繰り返すように録画される・・。</p>\n\n</div>\n<div class=\"section\">\n    <h3>原因は・・？</h3>\n    \n<ul>\n<li>iOS Safariで見えるもの: 問題なし</li>\n<li>WebRTC経由でChromeに届いたもの: 問題なし</li>\n<li>MediaRecorderで生成したもの: おかしい</li>\n</ul><p>という感じで、ChromeのMediaRecorderのバグなんだろうか・・？</p><p>ちなみにChromeのローカルでストリームを縦長にして、iOS Safariと同じアス比を再現してみても問題なかった。<br />\nChromeでリモートストリームを縦長にして再現してみても問題なかった。<br />\n<br />\n</p>\n\n</div>\n<div class=\"section\">\n    <h3>ChromeのMediaRecorderがバグってる</h3>\n    <p>自信はないけど、Chromeのバグだと思う。<br />\nというのも、FirefoxのMediaRecorderであれば問題なく録画できたから。</p><p><blockquote class=\"twitter-tweet\" data-lang=\"en\"><p lang=\"ja\" dir=\"ltr\">Chrome・・おまえ・・・ <a href=\"https://t.co/D1qAyZCo1w\">pic.twitter.com/D1qAyZCo1w</a></p>&mdash; りぃ (@leader22) <a href=\"https://twitter.com/leader22/status/919803162487242752?ref_src=twsrc%5Etfw\">October 16, 2017</a></blockquote> <script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script> </p><p>`.getSettings()`なんかアテにしてないとはいえ、明らかにおかしいChrome・・。</p><p>MediaRecorderやるならFirefox使おう！</p>\n\n</div>"
}
