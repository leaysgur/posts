{
  "title": "UIスレッドとWorkerスレッドで、コードの実行速度に差はあるのか",
  "html": "<p>普通の処理をUIスレッドで実行するのと、いわゆるWorkerスレッドで実行するのでは、どっちが速いのか。</p><p>用途とかはあるやろうけど、単にどっちが速いのかふと気になったので調べた。<br />\n<br />\n</p>\n\n<div class=\"section\">\n    <h3>事の発端</h3>\n    <p>いわゆる「しばらくお待ちください・・」的UIの裏側で行うような処理を、Workerで代替すれば早くなるのかが知りたかった。</p><p>UIスレッドからの介入が何もない場合に、裏で計算するとちょっとでも速くなったりしないかなーと。<br />\nもしくは、UIスレッドのほうがリソースが豊富で、何もしてないならUIスレッドでやるほうが速かったりするかなーとか。</p>\n\n</div>\n<div class=\"section\">\n    <h3>ベンチマークには</h3>\n    <p>Googleが作ったOctaneってやつを使ってみた。<br />\nいくつかの機能別の項目に分かれてて、それぞれのスコアがわかるようになってる。</p><p>処理の内容によって差がでることもある気はして、でもそれを手動のテストで調べるのは面倒くさかったので・・。</p>\n\n    <blockquote>\n        <p>公式: <a href=\"https://developers.google.com/octane/\">Octane &nbsp;|&nbsp; Google Developers</a><br />\nGitHub: <a href=\"https://github.com/chromium/octane\">GitHub - chromium/octane: The JavaScript Benchmark Suite for the modern web</a></p>\n\n    </blockquote>\n<p>ココでブラウザからもすぐ試せる。</p>\n\n    <blockquote>\n        <p><a href=\"http://chromium.github.io/octane/\">Octane 2.0 JavaScript Benchmark</a></p>\n\n    </blockquote>\n\n</div>\n<div class=\"section\">\n    <h3>というわけで</h3>\n    <p>わかりやすい見た目も全てはぎとって、Consoleにスコアを吐くだけにしてみた。<br />\nそして、肝心のWorkerで動かすとどうなるのかも試せるようにした。</p>\n\n    <blockquote>\n        <p><a href=\"https://github.com/leader22/octane-bench\">GitHub - leader22/octane-bench</a></p>\n\n    </blockquote>\n\n</div>\n<div class=\"section\">\n    <h3>結果</h3>\n    <p>ためした環境は以下。</p>\n\n<ul>\n<li>Max OS X 10.11.3</li>\n<li>Chrome 49.0.2623.28 beta (64-bit)</li>\n</ul><p>それぞれ実行したらじっと待つ。<br />\n何回かやったうちの1回の結果がコレ。</p>\n\n<table>\n    <tr>\n    <th>testName</th>\n    <th>UIScore</th>\n    <th>WorkerScore</th>\n    <th> UI / Worker</th>\n    </tr>\n    <tr>\n    <td>Richards</td>\n    <td>30257</td>\n    <td>29943</td>\n    <td>1.0104865911899275</td>\n    </tr>\n    <tr>\n    <td>DeltaBlue</td>\n    <td>42805</td>\n    <td>52657</td>\n    <td>0.8129023681561806</td>\n    </tr>\n    <tr>\n    <td>Crypto</td>\n    <td>27078</td>\n    <td>25817</td>\n    <td>1.0488437851028392</td>\n    </tr>\n    <tr>\n    <td>RayTrace</td>\n    <td>64083</td>\n    <td>60753</td>\n    <td>1.0548121080440471</td>\n    </tr>\n    <tr>\n    <td>EarleyBoyer</td>\n    <td>29398</td>\n    <td>31958</td>\n    <td>0.9198948620063834</td>\n    </tr>\n    <tr>\n    <td>RegExp</td>\n    <td>2930</td>\n    <td>4866</td>\n    <td>0.6021372790793259</td>\n    </tr>\n    <tr>\n    <td>Splay</td>\n    <td>15390</td>\n    <td>8125</td>\n    <td>1.894153846153846</td>\n    </tr>\n    <tr>\n    <td>SplayLatency</td>\n    <td>20561</td>\n    <td>15649</td>\n    <td>1.3138858713016806</td>\n    </tr>\n    <tr>\n    <td>NavierStokes</td>\n    <td>30657</td>\n    <td>30035</td>\n    <td>1.0207091726319295</td>\n    </tr>\n    <tr>\n    <td>PdfJS</td>\n    <td>17746</td>\n    <td>17798</td>\n    <td>0.9970783234071244</td>\n    </tr>\n    <tr>\n    <td>Mandreel</td>\n    <td>21794</td>\n    <td>24161</td>\n    <td>0.9020322006539464</td>\n    </tr>\n    <tr>\n    <td>MandreelLatency</td>\n    <td>46591</td>\n    <td>49852</td>\n    <td>0.9345863756719891</td>\n    </tr>\n    <tr>\n    <td>Gameboy</td>\n    <td>44380</td>\n    <td>53650</td>\n    <td>0.8272134203168686</td>\n    </tr>\n    <tr>\n    <td>CodeLoad</td>\n    <td>10607</td>\n    <td>9736</td>\n    <td>1.0894617912900575</td>\n    </tr>\n    <tr>\n    <td>Box2D</td>\n    <td>41832</td>\n    <td>47618</td>\n    <td>0.8784913268091898</td>\n    </tr>\n    <tr>\n    <td>zlib</td>\n    <td>51488</td>\n    <td>54518</td>\n    <td>0.9444220257529623</td>\n    </tr>\n    <tr>\n    <td>Typescript</td>\n    <td>31251</td>\n    <td>29413</td>\n    <td>1.0624893754462312</td>\n    </tr>\n    <tr>\n    <td>Total</td>\n    <td>25915</td>\n    <td>26156</td>\n    <td>0.990786053</td>\n    </tr>\n</table><p>数値はBigger is Betterだそうです。</p><p>何回かやってると回ごとにすごい差がついたりするところもある・・けど、だいたい一緒って感じ・・？</p><p>割と時間がかかるから10回くらいしか見てないけど、もっと回数やればブレも少なくなりそうではある。<br />\nが、まぁだいたい一緒ということでそれ以上の興味ががなくなったので調査終了(˘ω˘ )</p><p>ちなみに各ベンチが何をやってるか詳しく知りたい場合は、以下からどうぞ。</p>\n\n    <blockquote>\n        <p><a href=\"https://developers.google.com/octane/benchmark#the-test-suite-in-detail\">The Benchmark &nbsp;|&nbsp; Octane &nbsp;|&nbsp; Google Developers</a></p>\n\n    </blockquote>\n<p>ただWorkerとはいえ並列で流しまくるとガンガンスコアが下がってくので、どれくらいWorkerに振るかとかは別途考えないといけない模様。</p>\n\n</div>"
}
