{
  "title": "new Function() ではなく new AsyncFunction() したい",
  "html": "<p>我ながらニッチなことをやろうとしてるなって思う・・。</p><p>普通の生活をしてる分には、活躍する出番はないはず。`eval()`はもっと使わない。<br />\n<br />\n</p>\n\n<div class=\"section\">\n    <h3 id=\"new-Function\">new Function()</h3>\n    <pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink><span class=\"synStatement\">const</span> fn = <span class=\"synStatement\">new</span> <span class=\"synType\">Function</span>(<span class=\"synConstant\">&quot;a&quot;</span>, <span class=\"synConstant\">&quot;b&quot;</span>, <span class=\"synConstant\">&quot;return a + b&quot;</span>);\nconsole.log(fn(2, 6));\n</pre><p>という使い方ができる。</p><p>ユーザーからコードみたいな文字列を受け取って実行させたいが、`eval()`ほど無秩序にはしたくない時に使う。</p><p>`Function`コンストラクタはグローバルに生えてるけど、これで非同期な処理をしたい場合は？</p>\n\n</div>\n<div class=\"section\">\n    <h3 id=\"new-AsyncFunction\">new AsyncFunction()</h3>\n    <p>ってしたいけど、そんなものはグローバルに生えてないのでできない。</p><p>が、自作すればよいらしい。</p>\n\n    <blockquote>\n        <p><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncFunction\">AsyncFunction - JavaScript | MDN</a></p>\n\n    </blockquote>\n<p>こんな感じに。</p>\n<pre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink><span class=\"synStatement\">const</span> AsyncFunction = <span class=\"synType\">Object</span>.getPrototypeOf(async <span class=\"synIdentifier\">function</span>()<span class=\"synIdentifier\">{}</span>).constructor;\n\n<span class=\"synStatement\">const</span> code = <span class=\"synConstant\">`</span>\n<span class=\"synConstant\">  const a = await myClass.asyncA();</span>\n<span class=\"synConstant\">  return b = myClass.asyncB(a);</span>\n<span class=\"synConstant\">`</span>;\n\n<span class=\"synStatement\">const</span> asyncFn = <span class=\"synStatement\">new</span> AsyncFunction(<span class=\"synConstant\">&quot;myClass&quot;</span>, code);\n<span class=\"synStatement\">const</span> res = await asyncFn(myClass);\n</pre>\n</div>"
}
